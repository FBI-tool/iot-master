import{a as Fe,b as be}from"./chunk-OEZDHVVJ.js";import{a as Ce,b as Se}from"./chunk-Y6Y75R7J.js";import"./chunk-BE4ZTW6G.js";import{a as _e,d as ye,e as Ne,g as xe}from"./chunk-IT2U3YUS.js";import{Ab as le,Ba as I,Db as ce,Eb as ue,Hb as de,Ib as ze,Nb as fe,Rb as ge,T as w,Tb as he,U as M,Ub as ve,ab as te,bb as ne,c as $,cb as ie,db as oe,e as U,eb as re,f as W,h as J,j as K,lb as me,m as Q,n as Y,o as Z,ob as pe,p as ee,tb as ae,vb as T,xb as X,yb as se}from"./chunk-FZUU2ZSO.js";import{Ca as p,Da as u,Kb as A,La as o,Sa as S,Ta as r,Tb as L,Ua as m,Va as s,Z as y,Za as b,a as G,b as R,ba as g,bb as z,ca as N,db as f,fc as q,ga as x,gb as h,ha as F,hb as l,hc as D,ic as H,jb as O,kc as B,lb as v,mb as E,pb as V,va as j,yb as _}from"./chunk-Q2QJEMPV.js";function Xe(n,t){if(n&1&&s(0,"img",13),n&2){let c=f().$implicit;o("src",c.icon,j)}}function Pe(n,t){n&1&&s(0,"i",14)}function Be(n,t){if(n&1&&s(0,"i",15),n&2){let c=f().$implicit;o("routerLink",c.id+"/edit")}}function ke(n,t){if(n&1){let c=b();s(0,"span",16),r(1,"nz-dropdown-menu",null,17)(3,"ul",18)(4,"li",19),z("nzOnConfirm",function(){x(c);let i=f().$implicit,a=f();return F(a.delete(i.id))}),s(5,"span",20),l(6," \u5220\u9664 "),m()()()}if(n&2){let c=h(2);o("nzDropdownMenu",c)}}var Ge=(n,t,c)=>[n,t,c];function Re(n,t){if(n&1&&(r(0,"nz-col",6)(1,"nz-card",7),s(2,"nz-card-meta",8),m(),S(3,Xe,1,1,"ng-template",null,9,_)(5,Pe,1,0,"ng-template",null,10,_)(7,Be,1,1,"ng-template",null,11,_)(9,ke,7,1,"ng-template",null,12,_),m()),n&2){let c=t.$implicit,e=h(4),i=h(6),a=h(8),d=h(10);o("nzXs",12)("nzSm",8)("nzMd",6)("nzLg",4)("nzXl",3)("nzXXl",2),p(1),o("nzCover",e)("nzActions",V(10,Ge,i,a,d)),p(1),o("nzTitle",c.name)("nzDescription",c.description)}}var je=()=>[4,4],Ee=(()=>{let t=class t{constructor(e,i,a,d){this.ms=e,this.router=i,this.rs=a,this.msg=d,this.total=0,this.nzPageIndex=1,this.nzPageSize=10,this.query={limit:20,skip:0},this.value="",this.plugins=[{id:"modbus",name:"Modbus",description:"Modbus\u534F\u8BAE\u63D2\u4EF6",icon:"/assets/app.png"},{id:"influxdb",name:"Influxdb",description:"Influxdb\u65F6\u5E8F\u6570\u636E\u5E93",icon:"/assets/app.png"},{id:"scada",name:"Scada",description:"Web\u7EC4\u6001",icon:"/assets/app.png"},{id:"sms",name:"SMS",description:"\u77ED\u4FE1\u63A8\u9001",icon:"/assets/app.png"},{id:"call",name:"Call",description:"\u7535\u8BDD\u62A5\u8B66",icon:"/assets/app.png"},{id:"web-studio",name:"Web Studio",description:"\u4F4E\u4EE3\u7801\u5F00\u53D1\u5E73\u53F0",icon:"/assets/app.png"},{id:"goview",name:"GoView",description:"\u5927\u6570\u636E\u5C4F\u53EF\u89C6\u5316",icon:"/assets/app.png"}]}ngOnInit(){this.load()}load(){this.rs.post("plugin/search",this.query).subscribe(e=>{e.data.filter((i,a)=>{e.data[a]=R(G({},i),{icon:"/assets/app.png"})}),this.plugins=e.data,this.total=e.total},e=>{console.log("err:",e)})}delete(e){this.rs.get(`plugin/${e}/delete`,{}).subscribe(i=>{this.msg.success("\u5220\u9664\u6210\u529F"),this.load()},i=>{console.log("err:",i)}),this.load()}refresh(){this.nzPageIndex=1,this.load()}search(e){console.log(e),this.query.keyword={name:e},this.query.skip=0,this.load()}handleEdit(){this.router.navigateByUrl("admin/plugin/create")}};t.\u0275fac=function(i){return new(i||t)(u(de),u(D),u(X),u(T))},t.\u0275cmp=g({type:t,selectors:[["app-plugin"]],standalone:!0,features:[v],decls:6,vars:6,consts:[[1,"top"],["placeholder","\u8BF7\u8F93\u5165\u540D\u79F0",3,"onSearch"],[3,"showExportBtn","showImportBtn","showDelBtn","add"],[1,"content"],[3,"nzGutter"],[3,"nzXs","nzSm","nzMd","nzLg","nzXl","nzXXl",4,"ngFor","ngForOf"],[3,"nzXs","nzSm","nzMd","nzLg","nzXl","nzXXl"],["nzHoverable","",3,"nzCover","nzActions"],[3,"nzTitle","nzDescription"],["coverTemplate",""],["actionSetting",""],["actionEdit",""],["actionEllipsis",""],["alt","icon",3,"src"],["nz-icon","","nzType","setting"],["nz-icon","","nzType","edit",3,"routerLink"],["nz-icon","","nzType","ellipsis","nz-dropdown","","nzTrigger","click",3,"nzDropdownMenu"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","","nz-popconfirm","","nzPopconfirmTrigger","click","nzPopconfirmTitle","\u786E\u8BA4\u5220\u9664",3,"nzOnConfirm"],["nz-icon","","nzType","delete"]],template:function(i,a){i&1&&(r(0,"div",0)(1,"app-search-form",1),z("onSearch",function(C){return a.search(C)}),m(),r(2,"app-batch-btn",2),z("add",function(){return a.handleEdit()}),m()(),r(3,"div",3)(4,"nz-row",4),S(5,Re,11,14,"nz-col",5),m()()),i&2&&(p(2),o("showExportBtn",!1)("showImportBtn",!1)("showDelBtn",!1),p(2),o("nzGutter",E(5,je)),p(1),o("ngForOf",a.plugins))},dependencies:[Fe,be,A,Ce,Se,M,ce,ue,I,le,se,ge,w,H],styles:[".top[_ngcontent-%COMP%]{margin:10px 0 20px;display:flex;align-items:center}"]});let n=t;return n})();var De=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=g({type:t,selectors:[["app-plugin-detail"]],standalone:!0,features:[v],decls:2,vars:0,template:function(i,a){i&1&&(r(0,"p"),l(1,"plugin-detail works!"),m())}});let n=t;return n})();function Oe(n,t){if(n&1){let c=b();r(0,"button",18),z("click",function(){x(c);let i=f();return F(i.onSubmit())}),l(1,"\u4FDD\u5B58"),m()}}var Ve=()=>[",","\uFF0C"],k=(()=>{let t=class t{constructor(e,i,a,d,C){this.fb=e,this.router=i,this.msg=a,this.rs=d,this.route=C,this.buildFromGroup()}buildFromGroup(e){e=e||{},this.formGroup=this.fb.group({id:[this.id,[]],name:[e.name||"",[]],description:[e.description||"",[]],icon:[e.icon||"",[]],version:[e.version||"",[]],url:[e.url||"",[]],keywords:[e.keywords||[],[]]}),console.log(this.formGroup.value)}ngOnInit(){if(this.route.snapshot.paramMap.has("id")){this.id=this.route.snapshot.paramMap.get("id"),this.load();return}this.buildFromGroup()}load(){this.rs.get(`plugin/${this.id}`,{}).subscribe(e=>{this.buildFromGroup(e.data)},e=>{console.log("err:",e)})}onSubmit(){if(this.formGroup.valid){let e=this.id?`plugin/${this.id}`:"plugin/create";this.rs.post(e,this.formGroup.value).subscribe(i=>{this.router.navigateByUrl("admin/plugin"),this.msg.success("\u4FDD\u5B58\u6210\u529F")});return}else Object.values(this.formGroup.controls).forEach(e=>{e.invalid&&(e.markAsDirty(),e.updateValueAndValidity({onlySelf:!0}))})}onIconChange(e){}};t.\u0275fac=function(i){return new(i||t)(u(Y),u(D),u(T),u(X),u(q))},t.\u0275cmp=g({type:t,selectors:[["app-plugin-edit"]],standalone:!0,features:[v],decls:46,vars:33,consts:[["nz-button","","nzType","primary",3,"click",4,"nzSpaceItem"],["nz-form","",3,"formGroup"],["nzRequired","","nzFor","id",3,"nzSm","nzXs"],["nzErrorTip","",3,"nzSm","nzXs"],["nz-input","","formControlName","id"],["nzRequired","","nzFor","name",3,"nzSm","nzXs"],["nz-input","","formControlName","name"],["nzMode","tags","nzPlaceHolder","\u5173\u952E\u5B57\uFF0C\u9017\u53F7\u5206\u9694","formControlName","keywords",3,"nzTokenSeparators"],["nzFor","version",3,"nzSm","nzXs"],["nz-input","","formControlName","version"],["nzFor","description",3,"nzSm","nzXs"],[3,"nzMaxCharacterCount"],["rows","4","nz-input","","formControlName","description"],[3,"nzSm","nzXs"],["nzAction","/",3,"nzChange"],["nz-button",""],["nz-icon","","nzType","upload"],["nz-input","","formControlName","url"],["nz-button","","nzType","primary",3,"click"]],template:function(i,a){i&1&&(r(0,"nz-page-header")(1,"nz-page-header-title"),l(2),m(),r(3,"nz-page-header-extra")(4,"nz-space"),S(5,Oe,2,0,"button",0),m()()(),r(6,"form",1)(7,"nz-form-item")(8,"nz-form-label",2),l(9,"Id"),m(),r(10,"nz-form-control",3),s(11,"input",4),m()(),r(12,"nz-form-item")(13,"nz-form-label",5),l(14,"\u540D\u79F0"),m(),r(15,"nz-form-control",3),s(16,"input",6),m()(),r(17,"nz-form-item")(18,"nz-form-label",5),l(19,"\u5173\u952E\u5B57"),m(),r(20,"nz-form-control",3),s(21,"nz-select",7),m()(),r(22,"nz-form-item")(23,"nz-form-label",8),l(24,"\u7248\u672C"),m(),r(25,"nz-form-control",3),s(26,"input",9),m()(),r(27,"nz-form-item")(28,"nz-form-label",10),l(29,"\u8BF4\u660E"),m(),r(30,"nz-form-control",3)(31,"nz-textarea-count",11),s(32,"textarea",12),m()()(),r(33,"nz-form-item")(34,"nz-form-label",13),l(35,"\u5C01\u9762 "),m(),r(36,"nz-form-control",13)(37,"nz-upload",14),z("nzChange",function(C){return a.onIconChange(C)}),r(38,"button",15),s(39,"span",16),l(40," \u70B9\u51FB\u4E0A\u4F20 "),m()()()(),r(41,"nz-form-item")(42,"nz-form-label",8),l(43,"URL"),m(),r(44,"nz-form-control",3),s(45,"input",17),m()()()),i&2&&(p(2),O("\u63D2\u4EF6",a.id?"\u7F16\u8F91":"\u521B\u5EFA",""),p(4),o("formGroup",a.formGroup),p(2),o("nzSm",6)("nzXs",24),p(2),o("nzSm",14)("nzXs",24),p(3),o("nzSm",6)("nzXs",24),p(2),o("nzSm",14)("nzXs",24),p(3),o("nzSm",6)("nzXs",24),p(2),o("nzSm",14)("nzXs",24),p(1),o("nzTokenSeparators",E(32,Ve)),p(2),o("nzSm",6)("nzXs",24),p(2),o("nzSm",14)("nzXs",24),p(3),o("nzSm",6)("nzXs",24),p(2),o("nzSm",14)("nzXs",24),p(1),o("nzMaxCharacterCount",200),p(3),o("nzSm",6)("nzXs",24),p(2),o("nzSm",14)("nzXs",24),p(6),o("nzSm",6)("nzXs",24),p(2),o("nzSm",14)("nzXs",24))},dependencies:[ae,Ne,ye,_e,ve,he,Z,J,$,U,W,ee,K,Q,re,M,w,ne,te,oe,ie,me,pe,xe,I,fe]});let n=t;return n})();var Ae=[{path:"",component:Ee},{path:"create",component:k},{path:":id",component:De},{path:":id/edit",component:k}],we=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=N({type:t}),t.\u0275inj=y({imports:[B.forChild(Ae),B]});let n=t;return n})();var Et=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=N({type:t}),t.\u0275inj=y({imports:[L,we,ze]});let n=t;return n})();export{Et as PluginModule};
