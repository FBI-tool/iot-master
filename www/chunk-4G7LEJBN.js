import{a as Ge,b as Le}from"./chunk-5UFXXK45.js";import{a as Re}from"./chunk-QBVGC53F.js";import{a as Ae}from"./chunk-B4M7IYJ2.js";import{c as W,e as K,f as Y,g as Z,h as ee,i as te,j as we}from"./chunk-EXT7S62Z.js";import{b as $e}from"./chunk-OEZDHVVJ.js";import"./chunk-Y6Y75R7J.js";import{a as je,b as Ve}from"./chunk-BE4ZTW6G.js";import{a as ie,b as ne,c as Oe,d as oe,e as re}from"./chunk-IT2U3YUS.js";import{Ba as $,Fb as Me,Gb as ke,Hb as q,Ib as H,Ob as U,Pb as J,Rb as Q,Sb as Be,T as xe,Tb as F,U as Ne,Ub as T,ab as Ee,bb as Ie,c as G,cb as be,db as ye,e as R,eb as De,f as fe,g as he,h as ge,j as _e,lb as X,m as Se,n as Ce,nb as Fe,o as L,ob as Te,p as ve,pb as Pe,tb as b,vb as y,xb as D}from"./chunk-FZUU2ZSO.js";import{Ca as a,Da as s,Kb as O,La as c,Lb as ze,Sa as _,Sb as j,Ta as t,Tb as V,Ua as i,Va as f,Z as P,Za as v,a as le,b as ce,ba as x,bb as z,ca as M,db as u,fc as A,ga as S,gb as k,ha as C,hb as m,hc as E,ib as d,ic as I,jb as se,kc as pe,lb as N,nb as ue,qb as B,rb as w,yb as de}from"./chunk-Q2QJEMPV.js";function Ke(n,r){n&1&&(t(0,"button",19),m(1,"\u7F16\u8F91"),i())}function Ye(n,r){if(n&1){let l=v();t(0,"button",20),z("nzOnConfirm",function(){S(l);let o=u();return C(o.delete())}),m(1,"\u5220\u9664"),i()}}function Ze(n,r){if(n&1&&(t(0,"a",23),f(1,"i",24),i()),n&2){let l=u().$implicit;c("routerLink","/admin/space/"+l.id)}}function et(n,r){if(n&1){let l=v();t(0,"a",25),z("nzOnConfirm",function(){S(l);let o=u().$implicit,p=u();return C(p.deleteSpace(o.id))}),f(1,"i",26),i()}}function tt(n,r){if(n&1&&(t(0,"tr")(1,"td"),m(2),i(),t(3,"td"),m(4),i(),t(5,"td"),m(6),i(),t(7,"td"),m(8),i(),t(9,"td")(10,"nz-space"),_(11,Ze,2,1,"a",21)(12,et,2,0,"a",22),i()()()),n&2){let l=r.$implicit;a(2),d(l.id),a(2),d(l.name),a(2),d(l.devices),a(2),d(l.values)}}var Ue=(()=>{let r=class r{constructor(e,o,p,h){this.router=e,this.msg=o,this.rs=p,this.route=h,this.isVisible=!1,this.total=0,this.query={limit:20,skip:0},this.nzPageIndex=1,this.nzPageSize=10,this.value="",this.data={id:1,name:"\u9ED8\u8BA4\u7A7A\u95F4",description:"",created:new Date},this.plugins=[{id:"scene",name:"\u667A\u6167\u573A\u666F",icon:"assets/app.png",description:"\u667A\u6167\u573A\u666F\uFF0C\u8054\u52A8\u63A7\u5236"},{id:"screen",name:"\u6570\u636E\u5927\u5C4F",icon:"assets/app.png",description:""}],this.devices=[]}ngOnInit(){this.route.snapshot.paramMap.has("id")&&(this.id=this.route.snapshot.paramMap.get("id"),this.query.filter={project_id:this.id},this.load())}load(){this.rs.get(`space/${this.id}`).subscribe(e=>{this.data=e.data},e=>{console.log("err:",e)}),this.rs.get(`space/${this.id}/device`,{}).subscribe(e=>{e.data&&(this.devices=e.data),this.total=e.total},e=>{console.log("err:",e)})}nzPageSizeChange(e){this.nzPageSize=e,this.load()}nzPageIndexChange(e){this.nzPageIndex=e,this.load()}delete(){this.rs.get(`space/${this.id}/delete`,{}).subscribe(e=>{this.msg.success("\u5220\u9664\u6210\u529F"),this.router.navigateByUrl("admin")},e=>{console.log("err:",e)}),this.load()}deleteSpace(e){this.rs.get(`space/${e}/delete`,{}).subscribe(o=>{this.msg.success("\u5220\u9664\u6210\u529F"),this.load()},o=>{console.log("err:",o)}),this.load()}search(e){console.log(e),this.query.keyword={name:e},this.query.skip=0,this.load()}handleEdit(){this.router.navigateByUrl("admin/device/create")}handleCancel(){}handleOk(){}};r.\u0275fac=function(o){return new(o||r)(s(E),s(y),s(D),s(A))},r.\u0275cmp=x({type:r,selectors:[["app-space-detail"]],standalone:!0,features:[N],decls:46,vars:19,consts:[["nz-button","","routerLink","edit",4,"nzSpaceItem"],["nz-button","","nz-popconfirm","","nzPopconfirmTitle","\u786E\u8BA4\u5220\u9664",3,"nzOnConfirm",4,"nzSpaceItem"],["nzSize","small",3,"nzColumn"],["nzTitle","ID",3,"nzSpan"],["nzTitle","\u540D\u79F0",3,"nzSpan"],["nzTitle","\u521B\u5EFA\u65F6\u95F4",3,"nzSpan"],["nzTitle","\u8BF4\u660E",3,"nzSpan"],["nzText","\u63D2\u4EF6\u5217\u8868","nzOrientation","left"],[3,"plugins"],["nzText","\u8BBE\u5907\u5217\u8868","nzOrientation","left"],[1,"top"],["placeholder","\u8BF7\u8F93\u5165\u540D\u79F0",3,"onSearch"],["nzSize","large","nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","plus"],[3,"nzData","nzFrontPagination"],["table",""],[4,"ngFor","ngForOf"],[1,"pages"],["nzShowSizeChanger","","nzShowQuickJumper","",3,"nzPageIndex","nzPageSize","nzTotal","nzPageIndexChange","nzPageSizeChange"],["nz-button","","routerLink","edit"],["nz-button","","nz-popconfirm","","nzPopconfirmTitle","\u786E\u8BA4\u5220\u9664",3,"nzOnConfirm"],["title","\u7F16\u8F91",3,"routerLink",4,"nzSpaceItem"],["title","\u5220\u9664","nz-popconfirm","","nzPopconfirmTitle","\u786E\u8BA4\u5220\u9664",3,"nzOnConfirm",4,"nzSpaceItem"],["title","\u7F16\u8F91",3,"routerLink"],["nz-icon","","nzType","edit"],["title","\u5220\u9664","nz-popconfirm","","nzPopconfirmTitle","\u786E\u8BA4\u5220\u9664",3,"nzOnConfirm"],["nz-icon","","nzType","delete"]],template:function(o,p){if(o&1&&(t(0,"nz-page-header")(1,"nz-page-header-title"),m(2,"\u7A7A\u95F4\u8BE6\u60C5"),i(),t(3,"nz-page-header-subtitle"),m(4),i(),t(5,"nz-page-header-extra")(6,"nz-space"),_(7,Ke,2,0,"button",0)(8,Ye,2,0,"button",1),i()(),t(9,"nz-page-header-content")(10,"nz-descriptions",2)(11,"nz-descriptions-item",3),m(12),i(),t(13,"nz-descriptions-item",4),m(14),i(),t(15,"nz-descriptions-item",5),m(16),B(17,"date"),i(),t(18,"nz-descriptions-item",6),m(19),i()()()(),f(20,"nz-divider",7)(21,"app-plugins",8)(22,"nz-divider",9),t(23,"div",10)(24,"app-search-form",11),z("onSearch",function(g){return p.search(g)}),i(),t(25,"button",12),z("click",function(){return p.handleEdit()}),f(26,"i",13),m(27," \u7ED1\u5B9A "),i()(),t(28,"nz-table",14,15)(30,"thead")(31,"tr")(32,"th"),m(33,"ID"),i(),t(34,"th"),m(35,"\u540D\u79F0"),i(),t(36,"th"),m(37,"\u8BBE\u5907"),i(),t(38,"th"),m(39,"\u5C5E\u6027\u503C"),i(),t(40,"th"),m(41,"\u64CD\u4F5C"),i()()(),t(42,"tbody"),_(43,tt,13,4,"tr",16),i()(),t(44,"div",17)(45,"nz-pagination",18),z("nzPageIndexChange",function(g){return p.nzPageIndexChange(g)})("nzPageSizeChange",function(g){return p.nzPageSizeChange(g)}),i()()),o&2){let h=k(29);a(4),d(p.data.name),a(6),c("nzColumn",3),a(1),c("nzSpan",1),a(1),d(p.data.id),a(1),c("nzSpan",1),a(1),d(p.data.name),a(1),c("nzSpan",1),a(1),d(w(17,17,p.data.created)),a(2),c("nzSpan",2),a(1),d(p.data.description),a(2),c("plugins",p.plugins),a(7),c("nzData",p.devices)("nzFrontPagination",!1),a(15),c("ngForOf",h.data),a(2),c("nzPageIndex",p.nzPageIndex)("nzPageSize",p.nzPageSize)("nzTotal",p.total)}},dependencies:[$e,U,re,ie,ne,Oe,oe,T,F,b,Ve,je,j,Ae,I,Q,O,$,J,W,Y,Z,K,te,ee,Re],styles:[".top[_ngcontent-%COMP%]{margin:10px 0 20px;display:flex;align-items:center}"]});let n=r;return n})();function ot(n,r){n&1&&(t(0,"a",13),m(1,"\u7ED1\u5B9A\u8BBE\u5907"),i())}function rt(n,r){if(n&1){let l=v();t(0,"button",14),z("click",function(){S(l);let o=u();return C(o.onSubmit())}),m(1,"\u4FDD\u5B58"),i()}}var me=(()=>{let r=class r{constructor(e,o,p,h,g,We){this.fb=e,this.router=o,this.msg=p,this.rs=h,this.route=g,this.ms=We,this.data={name:"\u65B0\u8BBE\u5907"},this.deviceOption=[],this.product=[],this.gateway=[],this.filteredOptions=["Burns Bay Road","Downing Street","Wall Street"]}onInputChange(){console.log(this.formGroup.value.gateway_id)}buildFromGroup(e){e=e||{},this.formGroup=this.fb.group({id:[e.id||null,[]],project_id:[e.project_id||"",[]],name:[e.name||"",[]],description:[e.description||"",[]]})}onChoose(){this.ms.create({nzTitle:"\u8BBE\u5907\u7ED1\u5B9A",nzCentered:!0,nzMaskClosable:!1,nzContent:Ge,nzFooter:null}).afterClose.subscribe(e=>{console.log(e);let o=this.formGroup.value;e&&(e.status?(this.deviceOption=[{label:e.id,value:e.id}],this.formGroup.patchValue({devices:e.id})):o.devices&&o.devices===e.id&&this.formGroup.patchValue({devices:null}))})}ngOnInit(){if(this.route.snapshot.paramMap.has("id")&&(this.id=this.route.snapshot.paramMap.get("id"),this.load()),this.buildFromGroup(),this.route.snapshot.queryParamMap.has("project")){let e=this.route.snapshot.queryParamMap.get("project");this.formGroup.patchValue({project_id:e})}}load(){this.rs.get(`space/${this.id}`,{}).subscribe(e=>{this.buildFromGroup(e.data)},e=>{console.log("err:",e)})}onSubmit(){if(this.formGroup.valid){let e=this.id?`space/${this.id}`:"space/create";this.rs.post(e,this.formGroup.value).subscribe(o=>{this.router.navigateByUrl("/admin/space/"+o.data.id),this.msg.success("\u4FDD\u5B58\u6210\u529F")});return}else Object.values(this.formGroup.controls).forEach(e=>{e.invalid&&(e.markAsDirty(),e.updateValueAndValidity({onlySelf:!0}))})}onIconChange(e){}};r.\u0275fac=function(o){return new(o||r)(s(Ce),s(E),s(y),s(D),s(A),s(q))},r.\u0275cmp=x({type:r,selectors:[["app-space-edit"]],standalone:!0,features:[N],decls:31,vars:20,consts:[["nz-button","","routerLink","device",4,"nzSpaceItem"],["nz-button","","nzType","primary",3,"click",4,"nzSpaceItem"],["nz-form","",3,"formGroup","ngSubmit"],["nzFor","id",3,"nzSm","nzXs"],["nzErrorTip","",3,"nzSm","nzXs"],["nz-input","","formControlName","id","placeholder","\u9009\u586B\uFF0C\u9ED8\u8BA4\u968F\u673A"],["nzRequired","","nzFor","project_id",3,"nzSm","nzXs"],["nz-input","","formControlName","project_id"],["nzRequired","","nzFor","name",3,"nzSm","nzXs"],["nz-input","","formControlName","name"],["nzFor","description",3,"nzSm","nzXs"],[3,"nzMaxCharacterCount"],["nz-input","","formControlName","description"],["nz-button","","routerLink","device"],["nz-button","","nzType","primary",3,"click"]],template:function(o,p){o&1&&(t(0,"nz-page-header")(1,"nz-page-header-title"),m(2),i(),t(3,"nz-page-header-subtitle"),m(4),i(),t(5,"nz-page-header-extra")(6,"nz-space"),_(7,ot,2,0,"a",0)(8,rt,2,0,"button",1),i()()(),t(9,"form",2),z("ngSubmit",function(){return p.onSubmit()}),t(10,"nz-form-item")(11,"nz-form-label",3),m(12,"ID"),i(),t(13,"nz-form-control",4),f(14,"input",5),i()(),t(15,"nz-form-item")(16,"nz-form-label",6),m(17,"\u9879\u76EE"),i(),t(18,"nz-form-control",4),f(19,"input",7),i()(),t(20,"nz-form-item")(21,"nz-form-label",8),m(22,"\u540D\u79F0"),i(),t(23,"nz-form-control",4),f(24,"input",9),i()(),t(25,"nz-form-item")(26,"nz-form-label",10),m(27,"\u8BF4\u660E"),i(),t(28,"nz-form-control",4)(29,"nz-textarea-count",11),f(30,"textarea",12),i()()()()),o&2&&(a(2),se("\u7A7A\u95F4",p.id?"\u7F16\u8F91":"\u521B\u5EFA",""),a(2),d(p.data.name),a(5),c("formGroup",p.formGroup),a(2),c("nzSm",6)("nzXs",24),a(2),c("nzSm",14)("nzXs",24),a(3),c("nzSm",6)("nzXs",24),a(2),c("nzSm",14)("nzXs",24),a(3),c("nzSm",6)("nzXs",24),a(2),c("nzSm",14)("nzXs",24),a(3),c("nzSm",6)("nzXs",24),a(2),c("nzSm",14)("nzXs",24),a(1),c("nzMaxCharacterCount",200))},dependencies:[U,Le,b,re,oe,ne,ie,T,I,F,L,ge,G,R,fe,ve,_e,Se,De,Ne,xe,Ie,Ee,ye,be,X,Te],styles:[".flex[_ngcontent-%COMP%]{display:flex}"]});let n=r;return n})();function at(n,r){if(n&1){let l=v();t(0,"button",9),z("click",function(){S(l);let o=u();return C(o.refresh())}),f(1,"span",10),m(2," \u5237\u65B0 "),i()}}function pt(n,r){if(n&1){let l=v();t(0,"button",15),z("click",function(){S(l);let o=u(2);return C(o.search())}),m(1," \u641C\u7D22 "),i()}}function mt(n,r){if(n&1){let l=v();t(0,"div",11)(1,"nz-input-group",12)(2,"input",13),z("ngModelChange",function(o){S(l);let p=u();return C(p.value=o)}),i()(),_(3,pt,2,0,"ng-template",null,14,de),i()}if(n&2){let l=k(4),e=u();a(1),c("nzAddOnAfter",l),a(1),c("ngModel",e.value)}}function lt(n,r){n&1&&(t(0,"div")(1,"button",16),f(2,"span",17),m(3," \u65B0\u5EFA "),i()())}function ct(n,r){if(n&1&&(t(0,"a",23),f(1,"i",24),i()),n&2){let l=u(2).$implicit;c("routerLink",l.id+"/edit")}}function st(n,r){if(n&1){let l=v();t(0,"a",25),z("nzOnConfirm",function(){S(l);let o=u(2).$implicit,p=u();return C(p.delete(o.id))}),f(1,"i",26),i()}}function ut(n,r){n&1&&(t(0,"nz-space"),_(1,ct,2,1,"a",21)(2,st,2,0,"a",22),i())}function dt(n,r){if(n&1){let l=v();t(0,"a",27),z("click",function(){S(l);let o=u().$implicit,p=u();return C(p.select(o))}),m(1,"\u9009\u62E9 "),i()}}var zt=n=>["/admin/project",n];function ft(n,r){if(n&1&&(t(0,"tr")(1,"td")(2,"a",18),m(3),i()(),t(4,"td"),m(5),i(),t(6,"td")(7,"a",18),m(8),i()(),t(9,"td"),m(10),B(11,"date"),i(),t(12,"td"),_(13,ut,3,0,"nz-space",19)(14,dt,2,0,"a",20),i()()),n&2){let l=r.$implicit,e=u();a(2),c("routerLink",l.id),a(1),d(l.id),a(2),d(l.name),a(2),c("routerLink",ue(10,zt,l.project_id)),a(1),d(l.project),a(2),d(w(11,8,l.created)),a(3),c("ngIf",!e.ref),a(1),c("ngIf",e.ref)}}var Je=(()=>{let r=class r{constructor(e,o,p,h,g){this.route=e,this.rs=o,this.msg=p,this.ms=h,this.ref=g,this.total=0,this.nzPageIndex=1,this.nzPageSize=10,this.value="",this.spaces=[]}ngOnInit(){this.load()}refresh(){this.nzPageIndex=1,this.load()}open(e){this.route.navigateByUrl("admin/space/"+e.id)}select(e){this.ref&&this.ref.close(e)}edit(e){this.route.navigateByUrl("admin/space/"+e.id+"/edit")}search(){console.log(this.value),this.load()}delete(e){this.rs.get(`space/${e}/delete`,{}).subscribe(o=>{this.msg.success("\u5220\u9664\u6210\u529F"),this.load()},o=>{console.log("err:",o)}),this.load()}nzPageSizeChange(e){this.nzPageSize=e,this.load()}nzPageIndexChange(e){this.nzPageIndex=e,this.load()}create(){this.rs.post("space/create",{}).subscribe(e=>{this.load(),this.msg.success("\u4FDD\u5B58\u6210\u529F")})}load(){let e;e={limit:this.nzPageSize,skip:(this.nzPageIndex-1)*this.nzPageSize},this.value&&(e=ce(le({},e),{filter:{id:this.value}})),this.rs.post("space/search",e).subscribe(o=>{let p=o.data;this.spaces=o.data,this.total=o.total},o=>{console.log("err:",o)})}};r.\u0275fac=function(o){return new(o||r)(s(E),s(D),s(y),s(q),s(ke,8))},r.\u0275cmp=x({type:r,selectors:[["app-space"]],standalone:!0,features:[N],decls:22,vars:6,consts:[[1,"toolbar"],["nz-button","","nzType","primary",3,"click",4,"nzSpaceItem"],["class","search",4,"nzSpaceItem"],[4,"nzSpaceItem"],[3,"nzData","nzFrontPagination"],["table",""],[4,"ngFor","ngForOf"],[1,"pages"],["nzShowSizeChanger","","nzShowQuickJumper","",3,"nzPageIndex","nzPageSize","nzTotal","nzPageIndexChange","nzPageSizeChange"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","reload"],[1,"search"],["nzSearch","",3,"nzAddOnAfter"],["nz-input","","placeholder","\u8BF7\u8F93\u5165\u5173\u952E\u5B57",3,"ngModel","ngModelChange"],["suffixButton",""],["nz-button","","nzType","primary","nzSearch","",3,"click"],["nz-button","","nzType","primary","nzShape","round","routerLink","create"],["nz-icon","","nzType","plus"],[3,"routerLink"],[4,"ngIf"],["title","\u9009\u62E9",3,"click",4,"ngIf"],["title","\u7F16\u8F91",3,"routerLink",4,"nzSpaceItem"],["title","\u5220\u9664","nz-popconfirm","","nzPopconfirmTitle","\u786E\u8BA4\u5220\u9664",3,"nzOnConfirm",4,"nzSpaceItem"],["title","\u7F16\u8F91",3,"routerLink"],["nz-icon","","nzType","edit"],["title","\u5220\u9664","nz-popconfirm","","nzPopconfirmTitle","\u786E\u8BA4\u5220\u9664",3,"nzOnConfirm"],["nz-icon","","nzType","delete"],["title","\u9009\u62E9",3,"click"]],template:function(o,p){o&1&&(t(0,"nz-space",0),_(1,at,3,0,"button",1)(2,mt,5,2,"div",2)(3,lt,4,0,"div",3),i(),t(4,"nz-table",4,5)(6,"thead")(7,"tr")(8,"th"),m(9,"ID"),i(),t(10,"th"),m(11,"\u540D\u79F0"),i(),t(12,"th"),m(13,"\u9879\u76EE"),i(),t(14,"th"),m(15,"\u521B\u5EFA\u65F6\u95F4"),i(),t(16,"th"),m(17,"\u64CD\u4F5C"),i()()(),t(18,"tbody"),_(19,ft,15,12,"tr",6),i()(),t(20,"div",7)(21,"nz-pagination",8),z("nzPageIndexChange",function(g){return p.nzPageIndexChange(g)})("nzPageSizeChange",function(g){return p.nzPageSizeChange(g)}),i()()),o&2&&(a(4),c("nzData",p.spaces)("nzFrontPagination",!1),a(15),c("ngForOf",p.spaces),a(2),c("nzPageIndex",p.nzPageIndex)("nzPageSize",p.nzPageSize)("nzTotal",p.total))},dependencies:[V,O,ze,j,we,Y,W,K,te,Z,ee,H,L,G,R,he,Pe,X,Fe,Be,Q,$,Me,J,T,b,F,I],styles:[".toolbar[_ngcontent-%COMP%]{padding:10px 0}.pages[_ngcontent-%COMP%]{padding:10px 0;display:flex;justify-content:center}"]});let n=r;return n})();var ht=[{path:"",component:Je},{path:"create",component:me},{path:":id",component:Ue},{path:":id/edit",component:me}],Qe=(()=>{let r=class r{};r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=M({type:r}),r.\u0275inj=P({imports:[pe.forChild(ht),pe]});let n=r;return n})();var xi=(()=>{let r=class r{};r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=M({type:r}),r.\u0275inj=P({imports:[V,Qe,H]});let n=r;return n})();export{xi as SpaceModule};
