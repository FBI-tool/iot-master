import{a as Ke,b as Qe,c as Je}from"./chunk-VVN35Y3F.js";import{a as Ue}from"./chunk-4TS6DFN4.js";import"./chunk-2RC4YZJA.js";import{a as qe,b as $e}from"./chunk-QBVGC53F.js";import{a as Ve}from"./chunk-B4M7IYJ2.js";import{c as Te,d as je,e as Me,f as we,g as Be,h as Xe,i as ke,j as Oe}from"./chunk-EXT7S62Z.js";import{b as We}from"./chunk-OEZDHVVJ.js";import{a as Ae}from"./chunk-Y6Y75R7J.js";import{a as He,b as Le}from"./chunk-BE4ZTW6G.js";import{a as F,b as W,c as Re,d as J,e as P,f as Y,h as Ge}from"./chunk-IT2U3YUS.js";import{Ca as ge,Hb as $,Ib as be,Nb as Fe,Ob as Pe,Rb as U,Sb as De,T as V,Tb as K,U as G,Ub as Q,Vb as Ie,ab as ve,bb as Ce,c as le,cb as Se,db as _e,e as ce,eb as Ne,f as de,h as ue,j as ze,lb as Ee,m as fe,n as H,o as L,ob as ye,p as he,pb as xe,tb as q,vb as x,xb as b}from"./chunk-FZUU2ZSO.js";import{Ca as r,Da as l,Fb as pe,Kb as O,La as s,Lb as se,Sa as g,Sb as A,Ta as i,Tb as T,Ua as n,Va as f,Z as M,Za as D,ba as v,bb as h,ca as w,db as _,fc as E,ga as C,gb as ee,ha as S,hb as m,hc as y,ib as z,ic as R,jb as I,kc as te,lb as N,mb as B,nb as ae,qb as X,rb as k,yb as me}from"./chunk-Q2QJEMPV.js";function rt(o,t){if(o&1&&m(0),o&2){let c=t.$implicit;I("\u603B\u5171 ",c," \u6761")}}function ot(o,t){o&1&&(i(0,"nz-tag",13),m(1," \u7981\u7528 "),n())}function at(o,t){o&1&&(i(0,"nz-tag",14),m(1," \u542F\u7528 "),n())}function mt(o,t){if(o&1){let c=D();i(0,"tr")(1,"td"),m(2),n(),i(3,"td"),m(4),n(),i(5,"td"),m(6),n(),i(7,"td"),g(8,ot,2,0,"nz-tag",10)(9,at,2,0,"nz-tag",11),n(),i(10,"td"),m(11),X(12,"date"),n(),i(13,"td")(14,"a",12),h("nzOnConfirm",function(){let p=C(c).$implicit,d=_();return S(d.submit(p.id))})("nzOnCancel",function(){C(c);let a=_();return S(a.cancel())}),m(15," \u7ED1\u5B9A "),n()()()}if(o&2){let c=t.$implicit;r(2),z(c.id),r(2),z(c.name),r(2),z(c.description),r(2),s("ngIf",c.disabled),r(1),s("ngIf",!c.disabled),r(2),z(k(12,6,c.created))}}var Ye=(()=>{let t=class t{constructor(e,a,p,d,u,Z){this.modal=e,this.router=a,this.rs=p,this.msg=d,this.location=u,this.route=Z,this.loading=!0,this.uploading=!1,this.datum=[],this.total=1,this.pageSize=20,this.pageIndex=1,this.query={},this.checked=!1,this.indeterminate=!1,this.setOfCheckedId=new Set,this.delResData=[],this.route.snapshot.paramMap.has("id")&&(this.id=this.route.snapshot.paramMap.get("id"))}reload(){this.datum=[],this.load()}load(){this.loading=!0,this.rs.post("plugin/search",this.query).subscribe(e=>{this.datum=e.data||[],this.total=e.total,this.setOfCheckedId.clear()}).add(()=>{this.loading=!1})}create(){let e="/user/create";location.pathname.startsWith("/admin")&&(e="/admin"+e),this.router.navigateByUrl(e)}submit(e,a){this.rs.post(`project/${this.id}/plugin/${e}`,{}).subscribe(p=>{this.msg.success("\u7ED1\u5B9A\u63D2\u4EF6"+e)}).add(()=>{this.loading=!1})}handleExport(){this.href="/api/user/export"}onQuery(e){this.load()}pageIndexChange(e){this.query.skip=e-1}pageSizeChange(e){this.query.limit=e}search(e){this.query.keyword={name:e},this.query.skip=0,this.load()}handleEdit(e){e?this.router.navigateByUrl("admin/user/edit/"+e):this.router.navigateByUrl("admin/user/create")}cancel(){this.msg.info("\u53D6\u6D88\u64CD\u4F5C")}};t.\u0275fac=function(a){return new(a||t)(l($),l(y),l(b),l(x),l(pe),l(E))},t.\u0275cmp=v({type:t,selectors:[["app-project-edit-plugin"]],standalone:!0,features:[N],decls:24,vars:10,consts:[["placeholder","\u8BF7\u8F93\u5165\u540D\u79F0",3,"onSearch"],["totalTemplate",""],["nzShowPagination","","nzShowSizeChanger","",1,"table",3,"nzData","nzLoading","nzFrontPagination","nzTotal","nzShowTotal","nzPageSize","nzPageIndex","nzPageSizeChange","nzPageIndexChange","nzQueryParams"],["basicTable",""],["nzColumnKey","id",3,"nzSortFn"],["nzColumnKey","name"],["nzColumnKey","description"],["nzColumnKey","disabled"],["nzColumnKey","created",3,"nzSortFn"],[4,"ngFor","ngForOf"],["nzColor","error",4,"ngIf"],["nzColor","success",4,"ngIf"],["nz-popconfirm","","nzPopconfirmTitle","\u786E\u5B9A\u7ED1\u5B9A?","nzPopconfirmPlacement","topLeft",3,"nzOnConfirm","nzOnCancel"],["nzColor","error"],["nzColor","success"]],template:function(a,p){if(a&1&&(i(0,"nz-page-header")(1,"nz-page-header-title"),m(2,"\u7ED1\u5B9A\u63D2\u4EF6"),n()(),i(3,"app-search-form",0),h("onSearch",function(u){return p.search(u)}),n(),g(4,rt,1,1,"ng-template",null,1,me),i(6,"nz-table",2,3),h("nzPageSizeChange",function(u){return p.pageSizeChange(u)})("nzPageIndexChange",function(u){return p.pageIndexChange(u)})("nzQueryParams",function(u){return p.onQuery(u)}),i(8,"thead")(9,"tr")(10,"th",4),m(11,"ID"),n(),i(12,"th",5),m(13,"\u540D\u79F0"),n(),i(14,"th",6),m(15,"\u63CF\u8FF0"),n(),i(16,"th",7),m(17,"\u72B6\u6001"),n(),i(18,"th",8),m(19,"\u65E5\u671F"),n(),i(20,"th"),m(21,"\u64CD\u4F5C"),n()()(),i(22,"tbody"),g(23,mt,16,8,"tr",9),n()()),a&2){let d=ee(5),u=ee(7);r(6),s("nzData",p.datum)("nzLoading",p.loading)("nzFrontPagination",!1)("nzTotal",p.total)("nzShowTotal",d)("nzPageSize",p.pageSize)("nzPageIndex",p.pageIndex),r(4),s("nzSortFn",!0),r(8),s("nzSortFn",!0),r(5),s("ngForOf",u.data)}},dependencies:[Y,P,F,De,U,ge,T,O,se,A,Oe,we,je,Te,Me,ke,Be,Xe,Qe,Ke,$e,We,Ie,Ge,xe,L],styles:[".table[_ngcontent-%COMP%]{margin-top:20px}"]});let o=t;return o})();var Ze=(()=>{let t=class t{constructor(e,a,p,d,u,Z){this.fb=e,this.router=a,this.msg=p,this.rs=d,this.route=u,this.ms=Z}};t.\u0275fac=function(a){return new(a||t)(l(H),l(y),l(x),l(b),l(E),l($))},t.\u0275cmp=v({type:t,selectors:[["app-project-edit-user"]],standalone:!0,features:[N],decls:4,vars:1,consts:[[3,"show"]],template:function(a,p){a&1&&(i(0,"nz-page-header")(1,"nz-page-header-title"),m(2,"\u7ED1\u5B9A\u7528\u6237"),n()(),f(3,"app-user",0)),a&2&&(r(3),s("show",!0))},dependencies:[Je,Y,P,F]});let o=t;return o})();function st(o,t){o&1&&(i(0,"button",14),m(1,"\u7F16\u8F91"),n())}function lt(o,t){if(o&1){let c=D();i(0,"button",15),h("nzOnConfirm",function(){C(c);let a=_();return S(a.delete())}),m(1,"\u5220\u9664"),n()}}function ct(o,t){if(o&1){let c=D();i(0,"div",16)(1,"nz-card",17),h("click",function(){let p=C(c).$implicit,d=_();return S(d.open(p))}),m(2),n()()}if(o&2){let c=t.$implicit;s("nzXXl",8)("nzXl",4)("nzLg",6)("nzMd",6)("nzSm",12)("nzXs",24),r(2),I(" ",c.name," ")}}var dt=o=>({project:o}),ut=()=>[16,16],et=(()=>{let t=class t{constructor(e,a,p,d){this.router=e,this.msg=a,this.rs=p,this.route=d,this.value="",this.data={id:1,name:"\u4EBA\u6C11\u533B\u9662",description:"\u4EBA\u6C11\u533B\u9662\u667A\u6167\u5927\u5C4F\u9879\u76EE",version:"3",keywords:["\u533B\u9662"],icon:"",url:"https://www.baidu.com",created:new Date},this.plugins=[{id:"scene",name:"\u667A\u6167\u573A\u666F",icon:"assets/app.png",description:"\u667A\u6167\u573A\u666F\uFF0C\u8054\u52A8\u63A7\u5236"},{id:"screen",name:"\u6570\u636E\u5927\u5C4F",icon:"assets/app.png",description:""}],this.spaces=[],this.space=[{id:1,name:"1\u53F7",product:"\u6E29\u5EA6\u8BA1",alias:"t1",online:new Date},{id:2,name:"2\u53F7",product:"\u6E29\u5EA6\u8BA1",alias:"t2",online:new Date},{id:3,name:"3\u53F7",product:"\u6E29\u5EA6\u8BA1",alias:"t3",online:new Date},{id:4,name:"4\u53F7",product:"\u6E29\u5EA6\u8BA1",alias:"t4",online:new Date}]}ngOnInit(){this.route.snapshot.paramMap.has("id")&&(this.id=this.route.snapshot.paramMap.get("id"),this.load(),this.loadSpaces())}load(){this.rs.get(`project/${this.id}`).subscribe(e=>{this.data=e.data},e=>{console.log("err:",e)})}loadSpaces(){this.rs.post("space/search",{limit:999999,skip:0,filter:{project_id:this.id}}).subscribe(e=>{e.data&&(this.spaces=e.data)},e=>{console.log("err:",e)})}delete(){this.rs.get(`project/${this.id}/delete`,{}).subscribe(e=>{this.msg.success("\u5220\u9664\u6210\u529F"),this.router.navigateByUrl("admin")},e=>{console.log("err:",e)}),this.load()}deleteSpace(e){this.rs.get(`space/${e}/delete`,{}).subscribe(a=>{this.msg.success("\u5220\u9664\u6210\u529F"),this.load()},a=>{console.log("err:",a)}),this.load()}open(e){this.router.navigateByUrl("/admin/space/"+e.id)}};t.\u0275fac=function(a){return new(a||t)(l(y),l(x),l(b),l(E))},t.\u0275cmp=v({type:t,selectors:[["app-project-detail"]],standalone:!0,features:[N],decls:29,vars:21,consts:[["nz-button","","routerLink","edit",4,"nzSpaceItem"],["nz-button","","nz-popconfirm","","nzPopconfirmTitle","\u786E\u8BA4\u5220\u9664",3,"nzOnConfirm",4,"nzSpaceItem"],["nzSize","small",3,"nzColumn"],["nzTitle","ID",3,"nzSpan"],["nzTitle","\u540D\u79F0",3,"nzSpan"],["nzTitle","\u7248\u672C",3,"nzSpan"],["nzTitle","\u521B\u5EFA\u65F6\u95F4",3,"nzSpan"],["nzTitle","\u8BF4\u660E",3,"nzSpan"],["nzText","\u63D2\u4EF6\u5217\u8868","nzOrientation","left"],[3,"plugins"],["nzText","\u7A7A\u95F4\u5217\u8868","nzOrientation","left"],["nz-button","","routerLink","/admin/space/create",3,"queryParams"],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzXXl","nzXl","nzLg","nzMd","nzSm","nzXs",4,"ngFor","ngForOf"],["nz-button","","routerLink","edit"],["nz-button","","nz-popconfirm","","nzPopconfirmTitle","\u786E\u8BA4\u5220\u9664",3,"nzOnConfirm"],["nz-col","",3,"nzXXl","nzXl","nzLg","nzMd","nzSm","nzXs"],["nzHoverable","",3,"click"]],template:function(a,p){a&1&&(i(0,"nz-page-header")(1,"nz-page-header-title"),m(2,"\u9879\u76EE\u8BE6\u60C5"),n(),i(3,"nz-page-header-subtitle"),m(4),n(),i(5,"nz-page-header-extra")(6,"nz-space"),g(7,st,2,0,"button",0)(8,lt,2,0,"button",1),n()(),i(9,"nz-page-header-content")(10,"nz-descriptions",2)(11,"nz-descriptions-item",3),m(12),n(),i(13,"nz-descriptions-item",4),m(14),n(),i(15,"nz-descriptions-item",5),m(16),n(),i(17,"nz-descriptions-item",6),m(18),X(19,"date"),n(),i(20,"nz-descriptions-item",7),m(21),n()()()(),f(22,"nz-divider",8)(23,"app-plugins",9)(24,"nz-divider",10),i(25,"button",11),m(26,"\u65B0\u5EFA\u7A7A\u95F4"),n(),i(27,"div",12),g(28,ct,3,7,"div",13),n()),a&2&&(r(4),z(p.data.name),r(6),s("nzColumn",3),r(1),s("nzSpan",1),r(1),z(p.data.id),r(1),s("nzSpan",1),r(1),z(p.data.name),r(1),s("nzSpan",1),r(1),z(p.data.version),r(1),s("nzSpan",1),r(1),z(k(19,16,p.data.created)),r(2),s("nzSpan",2),r(1),z(p.data.description),r(2),s("plugins",p.plugins),r(2),s("queryParams",ae(18,dt,p.id)),r(2),s("nzGutter",B(20,ut)),r(1),s("ngForOf",p.spaces))},dependencies:[Pe,P,F,W,Re,J,Q,K,q,Le,He,A,Ve,R,U,O,qe,V,G,Ae],styles:[`.spaces[_ngcontent-%COMP%] {\r
  .space{\r
\r
  }\r
}`]});let o=t;return o})();function zt(o,t){o&1&&(i(0,"a",16),m(1,"\u7ED1\u5B9A\u7528\u6237"),n())}function ft(o,t){if(o&1){let c=D();i(0,"button",17),h("click",function(){C(c);let a=_();return S(a.onSubmit())}),m(1,"\u4FDD\u5B58"),n()}}var ht=()=>[",","\uFF0C"],oe=(()=>{let t=class t{constructor(e,a,p,d,u){this.fb=e,this.router=a,this.msg=p,this.rs=d,this.route=u,this.data={name:"\u65B0\u9879\u76EE"},this.id="",this.buildFromGroup()}buildFromGroup(e){e=e||{},this.formGroup=this.fb.group({id:[this.id||"",[]],name:[e.name||"",[]],description:[e.description||"",[]],icon:[e.icon||"",[]],version:[e.version||"",[]],url:[e.url||"",[]],keywords:[e.keywords||[],[]]}),console.log(this.formGroup.value)}ngOnInit(){this.route.snapshot.paramMap.has("id")&&(this.id=this.route.snapshot.paramMap.get("id"),this.load())}load(){this.rs.get("project/"+this.id).subscribe(e=>{this.buildFromGroup(e.data)},e=>{console.log("err:",e)})}onSubmit(){if(this.formGroup.valid){let e=`project/${this.id||"create"}`;this.rs.post(e,this.formGroup.value).subscribe(a=>{this.router.navigateByUrl("admin"),this.msg.success("\u4FDD\u5B58\u6210\u529F")});return}else Object.values(this.formGroup.controls).forEach(e=>{e.invalid&&(e.markAsDirty(),e.updateValueAndValidity({onlySelf:!0}))})}onIconChange(e){}};t.\u0275fac=function(a){return new(a||t)(l(H),l(y),l(x),l(b),l(E))},t.\u0275cmp=v({type:t,selectors:[["app-project-edit"]],standalone:!0,features:[N],decls:41,vars:30,consts:[["nz-button","","routerLink","user",4,"nzSpaceItem"],["nz-button","","nzType","primary",3,"click",4,"nzSpaceItem"],["nz-form","",3,"formGroup","ngSubmit"],["nzFor","id",3,"nzSm","nzXs"],["nzErrorTip","",3,"nzSm","nzXs"],["nz-input","","formControlName","id","placeholder","\u9009\u586B\uFF0C\u9ED8\u8BA4\u968F\u673A"],["nzRequired","","nzFor","name",3,"nzSm","nzXs"],["nz-input","","formControlName","name"],["nzFor","name",3,"nzSm","nzXs"],["nzMode","tags","nzPlaceHolder","\u5173\u952E\u5B57\uFF0C\u9017\u53F7\u5206\u9694","formControlName","keywords",3,"nzTokenSeparators"],["nzFor","version",3,"nzSm","nzXs"],["nz-input","","formControlName","version"],["nzFor","description",3,"nzSm","nzXs"],[3,"nzMaxCharacterCount"],["rows","4","nz-input","","formControlName","description"],["nz-input","","formControlName","url"],["nz-button","","routerLink","user"],["nz-button","","nzType","primary",3,"click"]],template:function(a,p){a&1&&(i(0,"nz-page-header")(1,"nz-page-header-title"),m(2),n(),i(3,"nz-page-header-subtitle"),m(4),n(),i(5,"nz-page-header-extra")(6,"nz-space"),g(7,zt,2,0,"a",0)(8,ft,2,0,"button",1),n()()(),i(9,"form",2),h("ngSubmit",function(){return p.onSubmit()}),i(10,"nz-form-item")(11,"nz-form-label",3),m(12,"ID"),n(),i(13,"nz-form-control",4),f(14,"input",5),n()(),i(15,"nz-form-item")(16,"nz-form-label",6),m(17,"\u540D\u79F0"),n(),i(18,"nz-form-control",4),f(19,"input",7),n()(),i(20,"nz-form-item")(21,"nz-form-label",8),m(22,"\u5173\u952E\u5B57"),n(),i(23,"nz-form-control",4),f(24,"nz-select",9),n()(),i(25,"nz-form-item")(26,"nz-form-label",10),m(27,"\u7248\u672C"),n(),i(28,"nz-form-control",4),f(29,"input",11),n()(),i(30,"nz-form-item")(31,"nz-form-label",12),m(32,"\u8BF4\u660E"),n(),i(33,"nz-form-control",4)(34,"nz-textarea-count",13),f(35,"textarea",14),n()()(),i(36,"nz-form-item")(37,"nz-form-label",10),m(38,"URL"),n(),i(39,"nz-form-control",4),f(40,"input",15),n()()()),a&2&&(r(2),I("\u9879\u76EE",p.id?"\u7F16\u8F91":"\u521B\u5EFA",""),r(2),z(p.data.name),r(5),s("formGroup",p.formGroup),r(2),s("nzSm",6)("nzXs",24),r(2),s("nzSm",14)("nzXs",24),r(3),s("nzSm",6)("nzXs",24),r(2),s("nzSm",14)("nzXs",24),r(3),s("nzSm",6)("nzXs",24),r(2),s("nzSm",14)("nzXs",24),r(1),s("nzTokenSeparators",B(29,ht)),r(2),s("nzSm",6)("nzXs",24),r(2),s("nzSm",14)("nzXs",24),r(3),s("nzSm",6)("nzXs",24),r(2),s("nzSm",14)("nzXs",24),r(1),s("nzMaxCharacterCount",200),r(3),s("nzSm",6)("nzXs",24),r(2),s("nzSm",14)("nzXs",24))},dependencies:[T,q,P,J,W,F,Q,R,K,L,ue,le,ce,de,he,ze,fe,Ne,G,V,Ce,ve,_e,Se,Ee,ye,Fe]});let o=t;return o})();var gt=[{path:"",component:Ue},{path:"create",component:oe},{path:":id",component:et},{path:":id/edit",component:oe},{path:":id/edit/plugin",component:Ye},{path:":id/edit/user",component:Ze}],tt=(()=>{let t=class t{};t.\u0275fac=function(a){return new(a||t)},t.\u0275mod=w({type:t}),t.\u0275inj=M({imports:[te.forChild(gt),te]});let o=t;return o})();var bi=(()=>{let t=class t{};t.\u0275fac=function(a){return new(a||t)},t.\u0275mod=w({type:t}),t.\u0275inj=M({imports:[T,tt,be]});let o=t;return o})();export{bi as ProjectModule};
