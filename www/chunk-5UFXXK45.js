import{c as be,e as Oe,f as Ie,g as xe,h as Ae,i as De,j as Ee}from"./chunk-EXT7S62Z.js";import{Ba as re,Gb as ze,Ha as ae,Ia as le,Pb as _e,Rb as Ce,Ta as ce,Tb as ye,Ub as Se,Va as pe,Wa as T,Ya as ue,a as te,c as ie,e as ne,g as oe,lb as me,mb as he,nb as de,o as se,tb as fe,vb as ge,xb as ve}from"./chunk-FZUU2ZSO.js";import{B as V,Ca as l,Da as h,Eb as Y,Ha as $,I as R,Kb as E,La as u,Lb as G,Ra as W,S as D,Sa as d,Sb as X,Ta as a,Tb as K,U as k,Ua as s,Va as C,W as F,Wa as O,Xa as I,Z as M,Za as y,a as w,b as P,ba as b,bb as f,ca as B,da as j,db as m,eb as H,fb as Q,ga as z,gb as S,h as N,ha as _,hb as c,hc as J,ib as v,ic as ee,kb as Z,lb as x,qb as U,rb as q,ya as L,yb as A}from"./chunk-Q2QJEMPV.js";function Pe(i,n){if(i&1){let r=y();a(0,"button",10),f("click",function(){z(r);let t=m();return _(t.refresh())}),C(1,"span",11),c(2," \u5237\u65B0 "),s()}}function Ne(i,n){if(i&1){let r=y();a(0,"button",16),f("click",function(){z(r);let t=m(2);return _(t.search())}),c(1,"\u641C\u7D22"),s()}}function Ve(i,n){if(i&1){let r=y();a(0,"div",12)(1,"nz-input-group",13)(2,"input",14),f("ngModelChange",function(t){z(r);let o=m();return _(o.value=t)}),s()(),d(3,Ne,2,0,"ng-template",null,15,A),s()}if(i&2){let r=S(4),e=m();l(1),u("nzAddOnAfter",r),l(1),u("ngModel",e.value)}}function Re(i,n){i&1&&(a(0,"button",18),C(1,"span",19),c(2," \u65B0\u5EFA "),s())}function ke(i,n){if(i&1&&(a(0,"div"),d(1,Re,3,0,"button",17),s()),i&2){let r=m();l(1),u("ngIf",!r.ref)}}function Fe(i,n){if(i&1&&(a(0,"a",26),C(1,"i",27),s()),i&2){let r=m(2).$implicit;u("routerLink",r.id+"/edit")}}function Me(i,n){if(i&1){let r=y();a(0,"a",28),f("nzOnConfirm",function(){z(r);let t=m(2).$implicit,o=m();return _(o.delete(t.id))}),C(1,"i",29),s()}}function Be(i,n){i&1&&(O(0),a(1,"nz-space"),d(2,Fe,2,1,"a",24)(3,Me,2,0,"a",25),s(),I())}function je(i,n){if(i&1){let r=y();a(0,"a",32),f("nzOnConfirm",function(){z(r);let t=m(2).$implicit,o=m();return _(o.select(1,t.id))}),C(1,"i",33),s()}}function Le(i,n){if(i&1){let r=y();a(0,"a",34),f("nzOnConfirm",function(){z(r);let t=m(2).$implicit,o=m();return _(o.select(0,t.id))}),C(1,"i",35),s()}}function $e(i,n){i&1&&(a(0,"nz-space"),d(1,je,2,0,"a",30)(2,Le,2,0,"a",31),s())}function We(i,n){if(i&1&&(a(0,"tr")(1,"td")(2,"a",20),c(3),s()(),a(4,"td"),c(5),s(),a(6,"td")(7,"a",20),c(8),s()(),a(9,"td")(10,"a",20),c(11),s()(),a(12,"td")(13,"a",20),c(14),s()(),a(15,"td",21),c(16),U(17,"date"),s(),a(18,"td"),d(19,Be,4,0,"ng-container",22)(20,$e,3,0,"ng-template",null,23,A),s()()),i&2){let r=n.$implicit,e=S(21),t=m();l(2),u("routerLink",r.id),l(1),v(r.id),l(2),v(r.name),l(2),u("routerLink","/admin/gateway/"+r.gateway_id),l(1),v(r.gateway),l(2),u("routerLink","/admin/product/"+r.product_id),l(1),v(r.product),l(2),u("routerLink","/admin/project/"+r.project_id),l(1),v(r.project),l(1),u("title",r.online),l(1),v(q(17,13,r.online)),l(3),u("ngIf",!t.ref)("ngIfElse",e)}}var gt=(()=>{let n=class n{constructor(e,t,o,p){this.ref=e,this.route=t,this.rs=o,this.msg=p,this.total=0,this.nzPageIndex=1,this.nzPageSize=10,this.value="",this.devices=[]}ngOnInit(){this.load()}select(e,t){let o={status:e,id:t};this.ref&&this.ref.close(o)}refresh(){this.nzPageIndex=1,this.load()}open(e){this.route.navigateByUrl("admin/device/"+e.id)}edit(e){this.route.navigateByUrl("admin/device/"+e.id+"/edit")}search(){console.log(this.value),this.load()}delete(e){this.rs.get(`device/${e}/delete`,{}).subscribe(t=>{this.msg.success("\u5220\u9664\u6210\u529F"),this.load()},t=>{console.log("err:",t)}),this.load()}nzPageSizeChange(e){this.nzPageSize=e,this.load()}nzPageIndexChange(e){this.nzPageIndex=e,this.load()}load(){let e;e={limit:this.nzPageSize,skip:(this.nzPageIndex-1)*this.nzPageSize},this.value&&(e=P(w({},e),{keyword:{name:this.value}})),this.rs.post("device/search",e).subscribe(t=>{this.devices=t.data,this.total=t.total},t=>{console.log("err:",t)})}};n.\u0275fac=function(t){return new(t||n)(h(ze,8),h(J),h(ve),h(ge))},n.\u0275cmp=b({type:n,selectors:[["app-device"]],standalone:!0,features:[x],decls:28,vars:6,consts:[[1,"toolbar"],["nz-button","","nzType","primary",3,"click",4,"nzSpaceItem"],["class","search",4,"nzSpaceItem"],[4,"nzSpaceItem"],[1,"fill"],[3,"nzData","nzFrontPagination"],["table",""],[4,"ngFor","ngForOf"],[1,"pages"],["nzShowSizeChanger","","nzShowQuickJumper","",3,"nzPageIndex","nzPageSize","nzTotal","nzPageIndexChange","nzPageSizeChange"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","reload"],[1,"search"],["nzSearch","",3,"nzAddOnAfter"],["type","text","nz-input","","placeholder","\u8BF7\u8F93\u5165\u5173\u952E\u5B57",3,"ngModel","ngModelChange"],["suffixButton",""],["nz-button","","nzType","primary","nzSearch","",3,"click"],["nz-button","","nzType","primary","nzShape","round","routerLink","create",4,"ngIf"],["nz-button","","nzType","primary","nzShape","round","routerLink","create"],["nz-icon","","nzType","plus"],[3,"routerLink"],[3,"title"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["title","\u7F16\u8F91",3,"routerLink",4,"nzSpaceItem"],["title","\u5220\u9664","nz-popconfirm","","nzPopconfirmTitle","\u786E\u8BA4\u5220\u9664",3,"nzOnConfirm",4,"nzSpaceItem"],["title","\u7F16\u8F91",3,"routerLink"],["nz-icon","","nzType","edit"],["title","\u5220\u9664","nz-popconfirm","","nzPopconfirmTitle","\u786E\u8BA4\u5220\u9664",3,"nzOnConfirm"],["nz-icon","","nzType","delete"],["title","\u7ED1\u5B9A","nz-popconfirm","","nzPopconfirmTitle","\u786E\u8BA4\u7ED1\u5B9A",3,"nzOnConfirm",4,"nzSpaceItem"],["title","\u89E3\u7ED1","nz-popconfirm","","nzPopconfirmTitle","\u786E\u8BA4\u89E3\u7ED1",3,"nzOnConfirm",4,"nzSpaceItem"],["title","\u7ED1\u5B9A","nz-popconfirm","","nzPopconfirmTitle","\u786E\u8BA4\u7ED1\u5B9A",3,"nzOnConfirm"],["nz-icon","","nzType","link"],["title","\u89E3\u7ED1","nz-popconfirm","","nzPopconfirmTitle","\u786E\u8BA4\u89E3\u7ED1",3,"nzOnConfirm"],["nz-icon","","nzType","disconnect"]],template:function(t,o){if(t&1&&(a(0,"div",0)(1,"nz-space"),d(2,Pe,3,0,"button",1)(3,Ve,5,2,"div",2)(4,ke,2,1,"div",3),s(),C(5,"div",4),s(),a(6,"nz-table",5,6)(8,"thead")(9,"tr")(10,"th"),c(11,"ID"),s(),a(12,"th"),c(13,"\u540D\u79F0"),s(),a(14,"th"),c(15,"\u7F51\u5173"),s(),a(16,"th"),c(17,"\u4EA7\u54C1"),s(),a(18,"th"),c(19,"\u9879\u76EE"),s(),a(20,"th"),c(21,"\u4E0A\u7EBF\u65F6\u95F4"),s(),a(22,"th"),c(23,"\u64CD\u4F5C"),s()()(),a(24,"tbody"),d(25,We,22,15,"tr",7),s()(),a(26,"div",8)(27,"nz-pagination",9),f("nzPageIndexChange",function(g){return o.nzPageIndexChange(g)})("nzPageSizeChange",function(g){return o.nzPageSizeChange(g)}),s()()),t&2){let p=S(7);l(6),u("nzData",o.devices)("nzFrontPagination",!1),l(19),u("ngForOf",p.data),l(2),u("nzPageIndex",o.nzPageIndex)("nzPageSize",o.nzPageSize)("nzTotal",o.total)}},dependencies:[K,E,G,X,se,ie,ne,oe,Se,fe,re,me,de,ee,_e,ye,Ee,Ie,be,Oe,De,xe,Ae,Ce],styles:[".toolbar[_ngcontent-%COMP%]{padding:10px 0;display:flex}.toolbar[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]{flex:1}.pages[_ngcontent-%COMP%]{padding:10px 0;display:flex;justify-content:center}"]});let i=n;return i})();function Ze(i,n){if(i&1&&(O(0),c(1),I()),i&2){let r=m();l(1),v(r.nzLabel)}}var Ue=[[["nz-auto-option"]]],qe=["nz-auto-option"];var Ye=(()=>{let n=class n{constructor(){}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=b({type:n,selectors:[["nz-auto-optgroup"]],inputs:{nzLabel:"nzLabel"},exportAs:["nzAutoOptgroup"],standalone:!0,features:[x],ngContentSelectors:qe,decls:3,vars:1,consts:[[1,"ant-select-item","ant-select-item-group"],[4,"nzStringTemplateOutlet"]],template:function(t,o){t&1&&(H(Ue),a(0,"div",0),d(1,Ze,2,1,"ng-container",1),s(),Q(2)),t&2&&(l(1),u("nzStringTemplateOutlet",o.nzLabel))},dependencies:[le,ae],encapsulation:2,changeDetection:0});let i=n;return i})();var Ge={provide:te,useExisting:F(()=>Ke),multi:!0};function Xe(){return Error("Attempting to open an undefined instance of `nz-autocomplete`. Make sure that the id passed to the `nzAutocomplete` is correct and that you're attempting to open it after the ngAfterContentInit hook.")}var Ke=(()=>{let n=class n{get activeOption(){return this.nzAutocomplete&&this.nzAutocomplete.options.length?this.nzAutocomplete.activeItem:null}constructor(e,t,o,p,g,Te){this.ngZone=e,this.elementRef=t,this.overlay=o,this.viewContainerRef=p,this.nzInputGroupWhitSuffixOrPrefixDirective=g,this.document=Te,this.onChange=()=>{},this.onTouched=()=>{},this.panelOpen=!1,this.destroy$=new N,this.overlayRef=null,this.portal=null,this.previousValue=null}ngAfterViewInit(){this.nzAutocomplete&&this.nzAutocomplete.animationStateChange.pipe(D(this.destroy$)).subscribe(e=>{e.toState==="void"&&this.overlayRef&&(this.overlayRef.dispose(),this.overlayRef=null)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.destroyPanel()}writeValue(e){this.ngZone.runOutsideAngular(()=>Promise.resolve(null).then(()=>this.setTriggerValue(e)))}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){let t=this.elementRef.nativeElement;t.disabled=e,this.closePanel()}openPanel(){this.previousValue=this.elementRef.nativeElement.value,this.attachOverlay(),this.updateStatus()}closePanel(){this.panelOpen&&(this.nzAutocomplete.isOpen=this.panelOpen=!1,this.overlayRef&&this.overlayRef.hasAttached()&&(this.overlayRef.detach(),this.selectionChangeSubscription.unsubscribe(),this.overlayOutsideClickSubscription.unsubscribe(),this.optionsChangeSubscription.unsubscribe(),this.portal=null))}handleKeydown(e){let t=e.keyCode,o=t===38||t===40;t===27&&e.preventDefault(),this.panelOpen&&(t===27||t===9)?(this.activeOption&&this.activeOption.getLabel()!==this.previousValue&&this.setTriggerValue(this.previousValue),this.closePanel()):this.panelOpen&&t===13?this.nzAutocomplete.showPanel&&(e.preventDefault(),this.activeOption?this.activeOption.selectViaInteraction():this.closePanel()):this.panelOpen&&o&&this.nzAutocomplete.showPanel&&(e.stopPropagation(),e.preventDefault(),t===38?this.nzAutocomplete.setPreviousItemActive():this.nzAutocomplete.setNextItemActive(),this.activeOption&&this.activeOption.scrollIntoViewIfNeeded(),this.doBackfill())}handleInput(e){let t=e.target,o=this.document,p=t.value;t.type==="number"&&(p=p===""?null:parseFloat(p)),this.previousValue!==p&&(this.previousValue=p,this.onChange(p),this.canOpen()&&o.activeElement===e.target&&this.openPanel())}handleFocus(){this.canOpen()&&this.openPanel()}handleBlur(){this.onTouched()}subscribeOptionsChange(){return this.nzAutocomplete.options.changes.pipe(k(()=>this.positionStrategy.reapplyLastPosition()),R(0)).subscribe(()=>{this.resetActiveItem(),this.panelOpen&&this.overlayRef.updatePosition()})}subscribeSelectionChange(){return this.nzAutocomplete.selectionChange.subscribe(e=>{this.setValueAndClose(e)})}subscribeOverlayOutsideClick(){return this.overlayRef.outsidePointerEvents().pipe(V(e=>!this.elementRef.nativeElement.contains(e.target))).subscribe(()=>{this.closePanel()})}attachOverlay(){if(!this.nzAutocomplete)throw Xe();!this.portal&&this.nzAutocomplete.template&&(this.portal=new ce(this.nzAutocomplete.template,this.viewContainerRef)),this.overlayRef||(this.overlayRef=this.overlay.create(this.getOverlayConfig())),this.overlayRef&&!this.overlayRef.hasAttached()&&(this.overlayRef.attach(this.portal),this.selectionChangeSubscription=this.subscribeSelectionChange(),this.optionsChangeSubscription=this.subscribeOptionsChange(),this.overlayOutsideClickSubscription=this.subscribeOverlayOutsideClick(),this.overlayRef.detachments().pipe(D(this.destroy$)).subscribe(()=>{this.closePanel()})),this.nzAutocomplete.isOpen=this.panelOpen=!0}updateStatus(){this.overlayRef&&this.overlayRef.updateSize({width:this.nzAutocomplete.nzWidth||this.getHostWidth()}),this.nzAutocomplete.setVisibility(),this.resetActiveItem(),this.activeOption&&this.activeOption.scrollIntoViewIfNeeded()}destroyPanel(){this.overlayRef&&this.closePanel()}getOverlayConfig(){return new pe({positionStrategy:this.getOverlayPosition(),disposeOnNavigation:!0,scrollStrategy:this.overlay.scrollStrategies.reposition(),width:this.nzAutocomplete.nzWidth||this.getHostWidth()})}getConnectedElement(){return this.nzInputGroupWhitSuffixOrPrefixDirective?this.nzInputGroupWhitSuffixOrPrefixDirective.elementRef:this.elementRef}getHostWidth(){return this.getConnectedElement().nativeElement.getBoundingClientRect().width}getOverlayPosition(){let e=[new T({originX:"start",originY:"bottom"},{overlayX:"start",overlayY:"top"}),new T({originX:"start",originY:"top"},{overlayX:"start",overlayY:"bottom"})];return this.positionStrategy=this.overlay.position().flexibleConnectedTo(this.getConnectedElement()).withFlexibleDimensions(!1).withPush(!1).withPositions(e).withTransformOriginOn(".ant-select-dropdown"),this.positionStrategy}resetActiveItem(){let e=this.nzAutocomplete.getOptionIndex(this.previousValue);this.nzAutocomplete.clearSelectedOptions(null,!0),e!==-1?(this.nzAutocomplete.setActiveItem(e),this.nzAutocomplete.activeItem.select(!1)):this.nzAutocomplete.setActiveItem(this.nzAutocomplete.nzDefaultActiveFirstOption?0:-1)}setValueAndClose(e){let t=e.nzValue;this.setTriggerValue(e.getLabel()),this.onChange(t),this.elementRef.nativeElement.focus(),this.closePanel()}setTriggerValue(e){let t=this.nzAutocomplete.getOption(e),o=t?t.getLabel():e;this.elementRef.nativeElement.value=o??"",this.nzAutocomplete.nzBackfill||(this.previousValue=o)}doBackfill(){this.nzAutocomplete.nzBackfill&&this.nzAutocomplete.activeItem&&this.setTriggerValue(this.nzAutocomplete.activeItem.getLabel())}canOpen(){let e=this.elementRef.nativeElement;return!e.readOnly&&!e.disabled}};n.\u0275fac=function(t){return new(t||n)(h($),h(L),h(ue),h(W),h(he,8),h(Y,8))},n.\u0275dir=j({type:n,selectors:[["input","nzAutocomplete",""],["textarea","nzAutocomplete",""]],hostAttrs:["autocomplete","off","aria-autocomplete","list"],hostBindings:function(t,o){t&1&&f("focusin",function(){return o.handleFocus()})("blur",function(){return o.handleBlur()})("input",function(g){return o.handleInput(g)})("keydown",function(g){return o.handleKeydown(g)})},inputs:{nzAutocomplete:"nzAutocomplete"},exportAs:["nzAutocompleteTrigger"],standalone:!0,features:[Z([Ge])]});let i=n;return i})();var mi=(()=>{let n=class n{};n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=B({type:n}),n.\u0275inj=M({imports:[Ye]});let i=n;return i})();export{gt as a,mi as b};
