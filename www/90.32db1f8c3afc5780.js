"use strict";(self.webpackChunkiot_master_ui=self.webpackChunkiot_master_ui||[]).push([[90],{423:(q,F,a)=>{a.d(F,{h:()=>g});var f=a(433),l=a(235),e=a(4650),t=a(4575),B=a(1445),_=a(9651),E=a(7423),b=a(3679),T=a(6704),I=a(5635),O=a(6616),S=a(7044),M=a(1664),P=a(1206),N=a(6895),v=a(8e3),D=a(269),R=a(6903),k=a(7096),L=a(1243);function $(c,i){if(1&c&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&c){const n=i.$implicit;e.xp6(1),e.Oqu(n.label)}}function Z(c,i){if(1&c){const n=e.EpF();e.TgZ(0,"nz-input-number",16),e.NdJ("nzBlur",function(){e.CHM(n);const d=e.oxw(3);return e.KtG(d.change())}),e.qZA()}if(2&c){const n=e.oxw().$implicit;e.Q6J("formControlName",n.name)("nzPlaceHolder",n.placeholder)}}function U(c,i){if(1&c){const n=e.EpF();e.TgZ(0,"nz-select",17),e.NdJ("ngModelChange",function(){e.CHM(n);const d=e.oxw(3);return e.KtG(d.change())}),e.qZA()}if(2&c){const n=e.oxw().$implicit;e.Q6J("formControlName",n.name)("nzPlaceHolder",n.placeholder)("nzOptions",n.options)}}function J(c,i){if(1&c&&e._UZ(0,"nz-switch",18),2&c){const n=e.oxw().$implicit;e.Q6J("formControlName",n.name)}}function K(c,i){if(1&c&&e._UZ(0,"nz-switch",18),2&c){const n=e.oxw().$implicit;e.Q6J("formControlName",n.name)}}function Y(c,i){if(1&c){const n=e.EpF();e.TgZ(0,"input",19),e.NdJ("blur",function(){e.CHM(n);const d=e.oxw(3);return e.KtG(d.change())}),e.qZA()}if(2&c){const n=e.oxw().$implicit;e.Q6J("placeholder",n.placeholder||"")("formControlName",n.name)}}function h(c,i){if(1&c&&(e.TgZ(0,"td"),e.ynx(1,11),e.YNc(2,Z,1,2,"nz-input-number",12),e.YNc(3,U,1,3,"nz-select",13),e.YNc(4,J,1,1,"nz-switch",14),e.YNc(5,K,1,1,"nz-switch",14),e.YNc(6,Y,1,2,"input",15),e.BQk(),e.qZA()),2&c){const n=i.$implicit;e.xp6(1),e.Q6J("ngSwitch",n.type),e.xp6(1),e.Q6J("ngSwitchCase","number"),e.xp6(1),e.Q6J("ngSwitchCase","select"),e.xp6(1),e.Q6J("ngSwitchCase","switch"),e.xp6(1),e.Q6J("ngSwitchCase","bool")}}function y(c,i){1&c&&e._UZ(0,"span",20)}function m(c,i){if(1&c){const n=e.EpF();e.TgZ(0,"span",21),e.NdJ("click",function(){e.CHM(n);const d=e.oxw().index,x=e.oxw();return e.KtG(x.handleCopyProperTy(d))}),e.qZA()}}function C(c,i){if(1&c){const n=e.EpF();e.TgZ(0,"span",22),e.NdJ("click",function(){e.CHM(n);const d=e.oxw().index,x=e.oxw();return e.KtG(x.propertyDel(d))}),e.qZA()}}function A(c,i){if(1&c&&(e.TgZ(0,"tr",6),e.YNc(1,h,7,5,"td",3),e.TgZ(2,"td",7)(3,"nz-space"),e.YNc(4,y,1,0,"span",8),e.YNc(5,m,1,0,"span",9),e.YNc(6,C,1,0,"span",10),e.qZA()()()),2&c){const n=i.index,s=e.oxw();e.Q6J("formGroupName",n),e.xp6(1),e.Q6J("ngForOf",s._items)}}let Q=(()=>{class c{set items(n){const s={};n.forEach(d=>{s[d.name]=d.default}),this.row=s,this._items=n}constructor(n,s){this.msg=n,this.fb=s,this.row={},this._items=[],this.onChanged=()=>{},this.onTouched=()=>{},this.data={}}ngOnInit(){this.formArray=this.fb.array([]),this.group=this.fb.group({array:this.formArray})}writeValue(n){const s=JSON.parse(JSON.stringify(this.row));n&&n.length&&n.forEach(d=>{const x=this.fb.group(Object.assign(s,d));this.formArray.push(x)})}registerOnChange(n){this.onChanged=n}registerOnTouched(n){this.onTouched=n}change(){const n=this.formArray.controls.map(s=>s.value);this.onChanged(n)}handleCopyProperTy(n){this.formArray.insert(n,this.fb.group(this.formArray.controls[n].value)),this.msg.success("\u590d\u5236\u6210\u529f"),this.change()}propertyDel(n){this.formArray.removeAt(n),this.change()}drop(n){(0,P.bA)(this.formArray.controls,n.previousIndex,n.currentIndex),this.change()}propertyAdd(){this.formArray.insert(0,this.fb.group(this.row))}}return c.\u0275fac=function(n){return new(n||c)(e.Y36(_.dD),e.Y36(f.qu))},c.\u0275cmp=e.Xpm({type:c,selectors:[["app-edit-table"]],inputs:{data:"data",items:"items"},features:[e._Bn([{provide:f.JU,useExisting:(0,e.Gpc)(()=>c),multi:!0}])],decls:11,vars:3,consts:[["type","button","nz-button","","nzType","primary",3,"click"],["type","button","nz-icon","","nzType","plus"],["nzTemplateMode","",3,"formGroup"],[4,"ngFor","ngForOf"],["cdkDropList","","formArrayName","array",3,"cdkDropListDropped"],["cdkDrag","",3,"formGroupName",4,"ngFor","ngForOf"],["cdkDrag","",3,"formGroupName"],[1,"td-oper"],["nz-icon","","nzType","drag","nzTheme","outline","title","\u79fb\u52a8\u5f53\u524d\u884c","style","cursor:move;","cdkDragHandle","",4,"nzSpaceItem"],["nz-icon","","nzType","copy","nzTheme","outline","title","\u590d\u5236\u5f53\u524d\u884c","style","cursor:pointer;",3,"click",4,"nzSpaceItem"],["nz-icon","","nzType","delete","nzTheme","outline","title","\u5220\u9664","style","cursor:pointer;",3,"click",4,"nzSpaceItem"],[3,"ngSwitch"],[3,"formControlName","nzPlaceHolder","nzBlur",4,"ngSwitchCase"],[3,"formControlName","nzPlaceHolder","nzOptions","ngModelChange",4,"ngSwitchCase"],[3,"formControlName",4,"ngSwitchCase"],["nz-input","",3,"placeholder","formControlName","blur",4,"ngSwitchDefault"],[3,"formControlName","nzPlaceHolder","nzBlur"],[3,"formControlName","nzPlaceHolder","nzOptions","ngModelChange"],[3,"formControlName"],["nz-input","",3,"placeholder","formControlName","blur"],["nz-icon","","nzType","drag","nzTheme","outline","title","\u79fb\u52a8\u5f53\u524d\u884c","cdkDragHandle","",2,"cursor","move"],["nz-icon","","nzType","copy","nzTheme","outline","title","\u590d\u5236\u5f53\u524d\u884c",2,"cursor","pointer",3,"click"],["nz-icon","","nzType","delete","nzTheme","outline","title","\u5220\u9664",2,"cursor","pointer",3,"click"]],template:function(n,s){1&n&&(e.TgZ(0,"button",0),e.NdJ("click",function(){return s.propertyAdd()}),e._UZ(1,"i",1),e._uU(2," \u6dfb\u52a0\n"),e.qZA(),e.TgZ(3,"nz-table",2)(4,"thead")(5,"tr"),e.YNc(6,$,2,1,"th",3),e.TgZ(7,"th"),e._uU(8,"\u64cd\u4f5c"),e.qZA()()(),e.TgZ(9,"tbody",4),e.NdJ("cdkDropListDropped",function(x){return s.drop(x)}),e.YNc(10,A,7,2,"tr",5),e.qZA()()),2&n&&(e.xp6(3),e.Q6J("formGroup",s.group),e.xp6(3),e.Q6J("ngForOf",s._items),e.xp6(4),e.Q6J("ngForOf",s.formArray.controls))},dependencies:[N.sg,N.RF,N.n9,N.ED,I.Zp,O.ix,S.w,M.dQ,f.Fj,f.JJ,f.JL,f.sg,f.u,f.x0,f.CE,P.Wj,P.Zt,P.Bh,v.Vq,D.N8,D.Uo,D._C,D.Om,D.p0,D.$Z,E.Ls,R.NU,R.$1,k._V,L.i]}),c})();var H=a(9054),W=a(3224);function j(c,i){1&c&&(e.TgZ(0,"button",27),e._UZ(1,"i",28),e._uU(2," \u6dfb\u52a0 "),e.qZA())}function G(c,i){1&c&&(e.TgZ(0,"button",27),e._UZ(1,"i",28),e._uU(2," \u6dfb\u52a0 "),e.qZA())}const V=function(){return{authorization:"authorization-text"}};let g=(()=>{class c{constructor(n,s,d,x){this.fb=n,this.router=s,this.rs=d,this.msg=x,this.listData=[{label:"\u540d\u79f0(ID)",name:"name"},{label:"\u663e\u793a",name:"label"},{label:"\u7c7b\u578b",name:"type",type:"select",default:"int",options:[{label:"\u6574\u6570",value:"int"},{label:"\u6d6e\u70b9\u6570",value:"float"},{label:"\u5e03\u5c14\u578b",value:"bool"},{label:"\u6587\u672c",value:"text"},{label:"\u679a\u4e3e",value:"enum"},{label:"\u6570\u7ec4",value:"array"},{label:"\u5bf9\u8c61",value:"object"}]},{label:"\u5355\u4f4d",name:"unit"},{label:"\u6a21\u5f0f",name:"mode",type:"select",default:"rw",options:[{label:"\u53ea\u8bfb",value:"r"},{label:"\u8bfb\u5199",value:"rw"}]}],this.parameterslistData=[{label:"\u540d\u79f0(ID)",name:"name"},{label:"\u663e\u793a",name:"label"},{label:"\u6700\u5927\u503c",name:"max",type:"number",default:0},{label:"\u6700\u5c0f\u503c",name:"min",type:"number",default:0},{label:"\u9ed8\u8ba4\u503c",name:"default",type:"number",default:0}],this.constraintslistData=[{label:"\u7b49\u7ea7",name:"level"},{label:"\u6807\u9898",name:"label"},{label:"\u6a21\u677f",name:"template"},{label:"\u8868\u8fbe\u5f0f",name:"expression"},{label:"\u62a5\u8b66\u5ef6\u8fdfs",name:"delay",type:"number"},{label:"\u518d\u6b21\u63d0\u9192",name:"repeat",type:"bool"},{label:"\u518d\u6b21\u63d0\u9192\u5ef6\u8fdfs",name:"repeat_delay",type:"number"},{label:"\u603b\u63d0\u9192\u6b21\u6570",name:"repeat_total",type:"number"}],this.validatorsListData=[{label:"\u6807\u9898",name:"title"},{label:"\u7b49\u7ea7",name:"level",type:"number",default:0},{label:"\u6a21\u677f",name:"template"},{label:"\u8868\u8fbe\u5f0f",name:"expression"},{label:"\u62a5\u8b66\u5ef6\u8fdfs",name:"delay",type:"number",default:5},{label:"\u518d\u6b21\u63d0\u9192",name:"repeat",type:"bool",default:!0},{label:"\u518d\u6b21\u63d0\u9192\u5ef6\u8fdfs",name:"repeat_delay",type:"number",default:300},{label:"\u603b\u63d0\u9192\u6b21\u6570",name:"repeat_total",type:"number",default:10}],this.aggregatorsListData=[{label:"\u5b9a\u65f6\u8ba1\u5212",name:"crontab"},{label:"\u8868\u8fbe\u5f0f",name:"expression"},{label:"\u7c7b\u578b",name:"type",type:"select",default:"inc",options:[{label:"\u589e\u52a0",value:"inc"},{label:"\u51cf\u5c11",value:"dec"},{label:"\u5e73\u5747",value:"avg"},{label:"\u8ba1\u6570",value:"count"},{label:"\u6700\u5c0f",value:"min"},{label:"\u6700\u5927",value:"max"},{label:"\u6c42\u5408",value:"sum"},{label:"\u6700\u540e",value:"last"},{label:"\u6700\u524d",value:"first"}]},{label:"\u8d4b\u503c",name:"assign"}]}ngOnInit(){this.id&&this.rs.get(`product/${this.id}`).subscribe(n=>{this.setData(n.data||{})}),this.build()}setData(n){const s=this.group.value;for(const d in s)n[d]&&(s[d]=n[d]);this.group.setValue(s)}build(n){this.group=this.fb.group({id:[(n=n||{}).id||"",[]],name:[n.name||"",[f.kI.required]],desc:[n.desc||"",[]],version:[n.version||"",[]],properties:[n.properties||[],[]],parameters:[n.parameters||[],[]],constraints:[n.constraints||[],[]],validators:[n.validators||[],[]],aggregators:[n.aggregators||[],[]]})}submit(){return new Promise(n=>{if(this.group.valid){let s=this.id?`product/${this.id}`:"product/create";const{desc:d}=this.group.value;if(d.length>200)return void this.msg.warning("\u3010\u8bf4\u660e\u3011\u5b57\u6570\u8fc7\u957f");this.rs.post(s,this.group.value).subscribe(x=>{this.msg.success("\u4fdd\u5b58\u6210\u529f"),n(!0)})}})}handleChange(n){"done"===n.file.status?this.msg.success(`${n.file.name} \u6587\u4ef6\u4e0a\u4f20\u6210\u529f`):"error"===n.file.status&&this.msg.error(`${n.file.name} \u6587\u4ef6\u4e0a\u4f20\u5931\u8d25.`)}handleCancel(){const n=`${(0,l.kh)()}/product/list`;this.router.navigateByUrl(n)}}return c.\u0275fac=function(n){return new(n||c)(e.Y36(f.qu),e.Y36(t.F0),e.Y36(B.s),e.Y36(_.dD))},c.\u0275cmp=e.Xpm({type:c,selectors:[["app-product-edit-component"]],inputs:{id:"id"},decls:47,vars:30,consts:[["nz-form","",3,"formGroup"],["nzFor","id",3,"nzSm","nzXs"],["nzErrorTip","",3,"nzSm","nzXs"],["nz-input","","formControlName","id","placeholder","\u9ed8\u8ba4\u4e3a\u968f\u673a\u751f\u6210"],["nzRequired","","nzFor","name",3,"nzSm","nzXs"],["nz-input","","formControlName","name"],["nzFor","version",3,"nzSm","nzXs"],["nz-input","","formControlName","version"],["nzFor","desc",3,"nzSm","nzXs"],[3,"nzMaxCharacterCount"],["rows","4","nz-input","","formControlName","desc"],[3,"nzSm","nzXs"],["nzAction","/",3,"nzHeaders","nzChange"],["nz-button",""],["nz-icon","","nzType","upload"],["nzHeader","\u5c5e\u6027","nzActive",""],["formControlName","properties",3,"items"],["functionEx",""],["nzDisabled","","nzHeader","\u529f\u80fd",3,"nzExtra"],["eventEx",""],["nzDisabled","","nzHeader","\u4e8b\u4ef6",3,"nzExtra"],["nzHeader","\u53d8\u91cf"],["formControlName","parameters",3,"items"],["nzHeader","\u6570\u636e\u68c0\u67e5"],["formControlName","validators",3,"items"],["nzHeader","\u6570\u636e\u805a\u5408"],["formControlName","aggregators",3,"items"],["type","button","nz-button","","nzType","primary"],["nz-icon","","nzType","plus"]],template:function(n,s){if(1&n&&(e.TgZ(0,"form",0)(1,"nz-form-item")(2,"nz-form-label",1),e._uU(3,"ID"),e.qZA(),e.TgZ(4,"nz-form-control",2),e._UZ(5,"input",3),e.qZA()(),e.TgZ(6,"nz-form-item")(7,"nz-form-label",4),e._uU(8,"\u540d\u79f0"),e.qZA(),e.TgZ(9,"nz-form-control",2),e._UZ(10,"input",5),e.qZA()(),e.TgZ(11,"nz-form-item")(12,"nz-form-label",6),e._uU(13,"\u7248\u672c"),e.qZA(),e.TgZ(14,"nz-form-control",2),e._UZ(15,"input",7),e.qZA()(),e.TgZ(16,"nz-form-item")(17,"nz-form-label",8),e._uU(18,"\u8bf4\u660e"),e.qZA(),e.TgZ(19,"nz-form-control",2)(20,"nz-textarea-count",9),e._UZ(21,"textarea",10),e.qZA()()(),e.TgZ(22,"nz-form-item")(23,"nz-form-label",11),e._uU(24,"\u56fe\u7247\u4e0a\u4f20"),e.qZA(),e.TgZ(25,"nz-form-control",11)(26,"nz-upload",12),e.NdJ("nzChange",function(x){return s.handleChange(x)}),e.TgZ(27,"button",13),e._UZ(28,"span",14),e._uU(29," \u70b9\u51fb\u4e0a\u4f20 "),e.qZA()()()(),e.TgZ(30,"nz-collapse")(31,"nz-collapse-panel",15),e._UZ(32,"app-edit-table",16),e.qZA(),e.YNc(33,j,3,0,"ng-template",null,17,e.W1O),e.TgZ(35,"nz-collapse-panel",18),e._uU(36," \u6682\u4e0d\u652f\u6301 "),e.qZA(),e.YNc(37,G,3,0,"ng-template",null,19,e.W1O),e.TgZ(39,"nz-collapse-panel",20),e._uU(40," \u6682\u4e0d\u652f\u6301 "),e.qZA(),e.TgZ(41,"nz-collapse-panel",21),e._UZ(42,"app-edit-table",22),e.qZA(),e.TgZ(43,"nz-collapse-panel",23),e._UZ(44,"app-edit-table",24),e.qZA(),e.TgZ(45,"nz-collapse-panel",25),e._UZ(46,"app-edit-table",26),e.qZA()()()),2&n){const d=e.MAs(34),x=e.MAs(38);e.Q6J("formGroup",s.group),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24),e.xp6(3),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24),e.xp6(3),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24),e.xp6(3),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24),e.xp6(1),e.Q6J("nzMaxCharacterCount",200),e.xp6(3),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24),e.xp6(1),e.Q6J("nzHeaders",e.DdM(29,V)),e.xp6(6),e.Q6J("items",s.listData),e.xp6(3),e.Q6J("nzExtra",d),e.xp6(4),e.Q6J("nzExtra",x),e.xp6(3),e.Q6J("items",s.parameterslistData),e.xp6(2),e.Q6J("items",s.validatorsListData),e.xp6(2),e.Q6J("items",s.aggregatorsListData)}},dependencies:[E.Ls,b.t3,b.SK,T.Lr,T.Nx,T.iK,T.Fd,I.w,I.Zp,O.ix,S.w,M.dQ,Q,f._Y,f.Fj,f.JJ,f.JL,f.sg,f.u,H.Zv,H.yH,W.FY],styles:[".cdk-drag-preview{display:table}  .cdk-drag-placeholder{opacity:0}"]}),c})()},7090:(q,F,a)=>{a.r(F),a.d(F,{ProductModule:()=>ft});var f=a(6895),l=a(1206),e=a(4575),t=a(8348),B=a(235),_=a(4650),E=a(7423),b=a(6616),T=a(7044),I=a(1664),O=a(1971),S=a(423);const M=["componentChild"];function P(r,p){if(1&r){const o=_.EpF();_.TgZ(0,"button",4),_.NdJ("click",function(){_.CHM(o);const z=_.oxw();return _.KtG(z.handleCancel())}),_._uU(1," \u53d6\u6d88 "),_.qZA(),_.TgZ(2,"button",5),_.NdJ("click",function(){_.CHM(o);const z=_.oxw();return _.KtG(z.submit())}),_._UZ(3,"i",6),_._uU(4," \u4fdd\u5b58 "),_.qZA()}}let N=(()=>{class r{constructor(o,u){this.router=o,this.route=u,this.id=""}ngOnInit(){}submit(){this.componentChild.submit()}handleCancel(){const o=`${(0,B.kh)()}/product/list`;this.router.navigateByUrl(o)}}return r.\u0275fac=function(o){return new(o||r)(_.Y36(e.F0),_.Y36(e.gz))},r.\u0275cmp=_.Xpm({type:r,selectors:[["app-products-edit"]],viewQuery:function(o,u){if(1&o&&_.Gf(M,5),2&o){let z;_.iGM(z=_.CRH())&&(u.componentChild=z.first)}},inputs:{id:"id"},decls:5,vars:3,consts:[["extra",""],[3,"nzTitle","nzExtra"],[3,"id"],["componentChild",""],["nz-button","",2,"margin-right","10px",3,"click"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","save","nzTheme","outline"]],template:function(o,u){if(1&o&&(_.YNc(0,P,5,0,"ng-template",null,0,_.W1O),_.TgZ(2,"nz-card",1),_._UZ(3,"app-product-edit-component",2,3),_.qZA()),2&o){const z=_.MAs(1);_.xp6(2),_.Q6J("nzTitle",u.id?"\u7f16\u8f91\u4ea7\u54c1":"\u521b\u5efa\u4ea7\u54c1")("nzExtra",z),_.xp6(1),_.Q6J("id",u.id)}},dependencies:[E.Ls,b.ix,T.w,I.dQ,O.bd,S.h],styles:[".cdk-drag-preview{display:table}  .cdk-drag-placeholder{opacity:0}"]}),r})();var v=a(1346);const D=[{path:"",pathMatch:"full",redirectTo:"list"},{path:"list",component:t.P},{path:"edit/:id",component:N},{path:"create",component:N},{path:"**",component:v.r}];let R=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=_.oAB({type:r}),r.\u0275inj=_.cJS({imports:[e.Bz.forChild(D),e.Bz]}),r})();var k=a(8284),L=a(3325),$=a(6704),Z=a(269),U=a(2577),J=a(433),K=a(7096),Y=a(9166),h=a(5635),y=a(6903),m=a(9054),C=a(8e3),A=a(445);let G=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=_.oAB({type:r}),r.\u0275inj=_.cJS({}),r})();var V=a(3353),g=a(6287);let i=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=_.oAB({type:r}),r.\u0275inj=_.cJS({imports:[f.ez]}),r})();var n=a(1811),s=a(7570);let mt=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=_.oAB({type:r}),r.\u0275inj=_.cJS({imports:[A.vT,f.ez,E.PV,s.cg,h.o7,n.YI,i,G,g.T,V.ud]}),r})();var ht=a(6497),gt=a(3224),zt=a(6960),Ct=a(1634);let ft=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=_.oAB({type:r}),r.\u0275inj=_.cJS({imports:[f.ez,R,k.wm,L.ip,Ct.uK,zt.Qp,E.PV,$.U5,h.o7,b.sL,ht._p,Z.HQ,U.S,Y.Y,J.UX,K.Zf,O.vh,y.zf,m.cD,C.LV,mt,l._t,gt.cS]}),r})()},8348:(q,F,a)=>{a.d(F,{P:()=>V});var f=a(5380),l=a(423),e=a(235),t=a(4650),B=a(6960),_=a(4575),E=a(1445),b=a(9651),T=a(6895),I=a(1634),O=a(7423),S=a(3679),M=a(6616),P=a(7044),N=a(1664),v=a(269),D=a(5227),R=a(297),k=a(2451),L=a(8989),$=a(7327),Z=a(6903),U=a(5545);function J(g,c){if(1&g){const i=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(i);const s=t.oxw();return t.KtG(s.reload())}),t._UZ(1,"i",5),t._uU(2," \u5237\u65b0 "),t.qZA()}if(2&g){const i=t.oxw();t.xp6(1),t.Q6J("nzSpin",i.loading)}}function K(g,c){if(1&g){const i=t.EpF();t.TgZ(0,"app-search-box",6),t.NdJ("onSearch",function(s){t.CHM(i);const d=t.oxw();return t.KtG(d.search(s))}),t.qZA()}}function Y(g,c){if(1&g){const i=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(i);const s=t.oxw(2);return t.KtG(s.handleEdit())}),t._UZ(1,"i",9),t._uU(2," \u521b\u5efa\u4ea7\u54c1 "),t.qZA()}}function h(g,c){if(1&g){const i=t.EpF();t.TgZ(0,"button",10),t._UZ(1,"span",11),t.TgZ(2,"a",12),t.NdJ("click",function(){t.CHM(i);const s=t.oxw(2);return t.KtG(s.handleExport())}),t._uU(3,"\u5bfc\u51fa"),t.qZA()()}if(2&g){const i=t.oxw(2);t.xp6(2),t.Q6J("href",i.href,t.LSH)}}function y(g,c){1&g&&t._UZ(0,"app-import",13),2&g&&t.Q6J("url","product/import")}function m(g,c){1&g&&(t.YNc(0,Y,3,0,"button",0),t.YNc(1,h,4,1,"button",7),t.YNc(2,y,1,1,"app-import",8))}function C(g,c){1&g&&t._uU(0),2&g&&t.hij("\u603b\u5171 ",c.$implicit," \u6761")}function A(g,c){if(1&g){const i=t.EpF();t.TgZ(0,"th",23),t.NdJ("nzCheckedChange",function(s){t.CHM(i);const d=t.oxw(2);return t.KtG(d.handleAllChecked(s))}),t.qZA()}if(2&g){const i=t.oxw(2);t.Q6J("nzChecked",i.checked)("nzIndeterminate",i.indeterminate)}}function Q(g,c){if(1&g){const i=t.EpF();t.TgZ(0,"td",27),t.NdJ("nzCheckedChange",function(s){t.CHM(i);const d=t.oxw().$implicit,x=t.oxw(2);return t.KtG(x.handleItemChecked(d.id,s))}),t.qZA()}if(2&g){const i=t.oxw().$implicit,n=t.oxw(2);t.Q6J("nzChecked",n.setOfCheckedId.has(i.id))}}function H(g,c){if(1&g){const i=t.EpF();t.TgZ(0,"tr",24),t.NdJ("dblclick",function(){const d=t.CHM(i).$implicit,x=t.oxw(2);return t.KtG(x.select(d))}),t.YNc(1,Q,1,1,"td",25),t.TgZ(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.ALo(10,"date"),t.qZA(),t.TgZ(11,"td")(12,"a",26),t.NdJ("click",function(){const d=t.CHM(i).$implicit,x=t.oxw(2);return t.KtG(x.select(d))}),t._uU(13," \u9009\u62e9 "),t.qZA()()()}if(2&g){const i=c.$implicit,n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",n.showAddBtn),t.xp6(2),t.Oqu(i.id),t.xp6(2),t.Oqu(i.name),t.xp6(2),t.Oqu(i.desc),t.xp6(2),t.Oqu(t.lcZ(10,5,i.created))}}function W(g,c){if(1&g){const i=t.EpF();t.ynx(0),t.YNc(1,C,1,1,"ng-template",null,14,t.W1O),t.TgZ(3,"nz-table",15,16),t.NdJ("nzPageSizeChange",function(s){t.CHM(i);const d=t.oxw();return t.KtG(d.pageSizeChange(s))})("nzPageIndexChange",function(s){t.CHM(i);const d=t.oxw();return t.KtG(d.pageIndexChange(s))})("nzQueryParams",function(s){t.CHM(i);const d=t.oxw();return t.KtG(d.onQuery(s))}),t.TgZ(5,"thead")(6,"tr"),t.YNc(7,A,1,2,"th",17),t.TgZ(8,"th",18),t._uU(9,"ID"),t.qZA(),t.TgZ(10,"th",19),t._uU(11,"\u540d\u79f0"),t.qZA(),t.TgZ(12,"th",20),t._uU(13,"\u8bf4\u660e"),t.qZA(),t.TgZ(14,"th",21),t._uU(15,"\u65e5\u671f"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"\u64cd\u4f5c"),t.qZA()()(),t.TgZ(18,"tbody"),t.YNc(19,H,14,7,"tr",22),t.qZA()(),t.BQk()}if(2&g){const i=t.MAs(2),n=t.MAs(4),s=t.oxw();t.xp6(3),t.Q6J("nzData",s.datum)("nzFrontPagination",!1)("nzLoading",s.loading)("nzScroll",s.getTableHeight())("nzShowTotal",i)("nzTotal",s.total)("nzPageSize",s.pageSize)("nzPageIndex",s.pageIndex),t.xp6(4),t.Q6J("ngIf",s.showAddBtn),t.xp6(1),t.Q6J("nzSortFn",!0),t.xp6(2),t.Q6J("nzSortFn",!0),t.xp6(4),t.Q6J("nzSortFn",!0),t.xp6(5),t.Q6J("ngForOf",n.data)}}function j(g,c){if(1&g){const i=t.EpF();t.TgZ(0,"div",32),t.NdJ("click",function(){const d=t.CHM(i).$implicit,x=t.oxw(2);return t.KtG(x.informate(d))}),t._UZ(1,"app-card",33),t.qZA()}if(2&g){const i=c.$implicit;t.xp6(1),t.Q6J("img","product.png")("id",i.id)("name",i.name)("title","\u4ea7\u54c1")}}function G(g,c){if(1&g){const i=t.EpF();t.ynx(0),t.TgZ(1,"div",28),t.YNc(2,j,2,4,"div",29),t.qZA(),t.TgZ(3,"app-detail",30),t.NdJ("edit",function(s){t.CHM(i);const d=t.oxw();return t.KtG(d.handleEdit(s))})("delete",function(s){t.CHM(i);const d=t.oxw();return t.KtG(d.delete(s))})("close",function(){t.CHM(i);const s=t.oxw();return t.KtG(s.close())}),t.qZA(),t.TgZ(4,"nz-pagination",31),t.NdJ("nzPageSizeChange",function(s){t.CHM(i);const d=t.oxw();return t.KtG(d.pageSizeChange(s))})("nzPageIndexChange",function(s){t.CHM(i);const d=t.oxw();return t.KtG(d.pageIndexChange(s))}),t.qZA(),t.BQk()}if(2&g){const i=t.oxw();t.xp6(1),t.Q6J("nzGutter",16),t.xp6(1),t.Q6J("ngForOf",i.datum),t.xp6(1),t.Q6J("isVisible",i.isVisible)("title","\u4ea7\u54c1")("chooseData",i.chooseData),t.xp6(1),t.Q6J("nzPageIndex",i.pageIndex)("nzTotal",i.total)("nzPageSize",i.pageSize)}}let V=(()=>{class g{constructor(i,n,s,d,x){this.modal=i,this.ref=n,this.router=s,this.rs=d,this.msg=x,this.isVisible=!1,this.chooseData={},this.loading=!1,this.datum=[],this.total=1,this.pageSize=20,this.pageIndex=1,this.query={},this.showAddBtn=!0,this.columnKeyNameArr=["name","desc"],this.uploading=!1,this.checked=!1,this.indeterminate=!1,this.setOfCheckedId=new Set,this.delResData=[],this.pageSizeChange(this.pageSize)}reload(){this.datum=[],this.load()}informate(i){this.isVisible=!0,this.rs.get(`product/${i.id}`,this.query).subscribe(n=>{this.chooseData=n.data}).add(()=>{this.loading=!1})}load(){this.loading=!0,this.rs.post("product/search",this.query).subscribe(i=>{this.datum=i.data||[],this.total=i.total}).add(()=>{this.loading=!1})}create(){let i="/product/create";location.pathname.startsWith("/admin")&&(i="/admin"+i),this.router.navigateByUrl(i)}delete(i,n){this.rs.get(`product/${i}/delete`).subscribe(s=>{n?n&&(this.delResData.push(s),n===this.delResData.length&&(this.msg.success("\u5220\u9664\u6210\u529f"),this.load())):(this.msg.success("\u5220\u9664\u6210\u529f"),this.datum=this.datum.filter(d=>d.id!==i))})}close(){this.isVisible=!1}onQuery(i){(0,f.r)(i,this.query),this.load()}pageIndexChange(i){this.query.skip=i-1,this.load()}pageSizeChange(i){this.query.limit=i,this.load()}search(i){this.query.keyword={name:i},this.query.skip=0,this.load()}edit(i){const n=`${(0,e.kh)()}/product/edit/${i}`;this.router.navigateByUrl(n)}handleNew(){const i=`${(0,e.kh)()}/product/create`;this.router.navigateByUrl(i)}handleEdit(i){this.isVisible=!1;const s=this.modal.create({nzTitle:i?"\u7f16\u8f91\u4ea7\u54c1":"\u521b\u5efa\u4ea7\u54c1",nzStyle:{top:"20px"},nzWidth:"80%",nzContent:l.h,nzComponentParams:{id:i},nzFooter:[{label:"\u53d6\u6d88",onClick:()=>{s.destroy()}},{label:"\u4fdd\u5b58",type:"primary",onClick:d=>{d.submit().then(()=>{s.destroy(),this.load()},()=>{})}}]})}select(i){this.ref&&this.ref.close(i)}cancel(){this.msg.info("\u53d6\u6d88\u64cd\u4f5c")}handleExport(){this.href="/api/product/export"}getTableHeight(){return(0,e.NC)(this)}handleBatchDel(){(0,e.mK)(this)}handleAllChecked(i){(0,e.Yk)(i,this)}handleItemChecked(i,n){(0,e.mp)(i,n,this)}}return g.\u0275fac=function(i){return new(i||g)(t.Y36(B.Sf),t.Y36(B.Lf,8),t.Y36(_.F0),t.Y36(E.s),t.Y36(b.dD))},g.\u0275cmp=t.Xpm({type:g,selectors:[["app-products"]],decls:7,vars:3,consts:[["nz-button","","nzType","primary",3,"click",4,"nzSpaceItem"],["placeholder","\u8bf7\u8f93\u5165\u4ea7\u54c1\u540d\u79f0",3,"onSearch",4,"nzSpaceItem"],[3,"ngIf"],[4,"ngIf"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","reload",3,"nzSpin"],["placeholder","\u8bf7\u8f93\u5165\u4ea7\u54c1\u540d\u79f0",3,"onSearch"],["nz-button","","nzType","primary","class","btn",4,"nzSpaceItem"],[3,"url",4,"nzSpaceItem"],["nz-icon","","nzType","plus"],["nz-button","","nzType","primary",1,"btn"],["nz-icon","","nzType","cloud-download","nzTheme","outline"],["download","filename",3,"href","click"],[3,"url"],["totalTemplate",""],["nzShowPagination","","nzShowSizeChanger","",3,"nzData","nzFrontPagination","nzLoading","nzScroll","nzShowTotal","nzTotal","nzPageSize","nzPageIndex","nzPageSizeChange","nzPageIndexChange","nzQueryParams"],["basicTable",""],[3,"nzChecked","nzIndeterminate","nzCheckedChange",4,"ngIf"],["nzColumnKey","id",3,"nzSortFn"],["nzColumnKey","name",3,"nzSortFn"],["nzColumnKey","desc"],["nzColumnKey","created",3,"nzSortFn"],[3,"dblclick",4,"ngFor","ngForOf"],[3,"nzChecked","nzIndeterminate","nzCheckedChange"],[3,"dblclick"],[3,"nzChecked","nzCheckedChange",4,"ngIf"],[3,"click"],[3,"nzChecked","nzCheckedChange"],["nz-row","",1,"card",3,"nzGutter"],["nz-col","","class","card-item",3,"click",4,"ngFor","ngForOf"],[3,"isVisible","title","chooseData","edit","delete","close"],["nzShowSizeChanger","",2,"position","fixed","bottom","0","right","10px",3,"nzPageIndex","nzTotal","nzPageSize","nzPageSizeChange","nzPageIndexChange"],["nz-col","",1,"card-item",3,"click"],[3,"img","id","name","title"]],template:function(i,n){1&i&&(t.TgZ(0,"app-toolbar")(1,"nz-space"),t.YNc(2,J,3,1,"button",0),t.YNc(3,K,1,0,"app-search-box",1),t.YNc(4,m,3,0,"ng-template",2),t.qZA()(),t.YNc(5,W,20,13,"ng-container",3),t.YNc(6,G,5,8,"ng-container",3)),2&i&&(t.xp6(4),t.Q6J("ngIf",n.showAddBtn),t.xp6(1),t.Q6J("ngIf",n.ref),t.xp6(1),t.Q6J("ngIf",!n.ref))},dependencies:[T.sg,T.O5,I.dE,O.Ls,S.t3,S.SK,M.ix,P.w,N.dQ,v.N8,v.qD,v.Uo,v._C,v.h7,v.Om,v.p0,v.$Z,v.g6,D.n,R.B,k.k,L.A,$.J,Z.NU,Z.$1,U.u],styles:[".btn[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:82px;height:32px;border-radius:3px}.btn[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;margin-left:5px;font-size:14px}.card[_ngcontent-%COMP%]{width:100%;box-sizing:border-box;padding:10px 20px}.card[_ngcontent-%COMP%]   .card-item[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px}.card[_ngcontent-%COMP%]   .card-item[_ngcontent-%COMP%]:hover{cursor:pointer}"]}),g})()},9054:(q,F,a)=>{a.d(F,{Zv:()=>K,cD:()=>Y,yH:()=>U});var f=a(655),l=a(4650),e=a(4968),t=a(2722),B=a(9300),_=a(2539),E=a(2536),b=a(3303),T=a(3187),I=a(445),O=a(4903),S=a(6895),M=a(7423),P=a(6287);const N=["*"],v=["collapseHeader"];function D(h,y){if(1&h&&(l.ynx(0),l._UZ(1,"span",7),l.BQk()),2&h){const m=y.$implicit,C=l.oxw(2);l.xp6(1),l.Q6J("nzType",m||"right")("nzRotate",C.nzActive?90:0)}}function R(h,y){if(1&h&&(l.TgZ(0,"div"),l.YNc(1,D,2,2,"ng-container",3),l.qZA()),2&h){const m=l.oxw();l.xp6(1),l.Q6J("nzStringTemplateOutlet",m.nzExpandedIcon)}}function k(h,y){if(1&h&&(l.ynx(0),l._uU(1),l.BQk()),2&h){const m=l.oxw();l.xp6(1),l.Oqu(m.nzHeader)}}function L(h,y){if(1&h&&(l.ynx(0),l._uU(1),l.BQk()),2&h){const m=l.oxw(2);l.xp6(1),l.Oqu(m.nzExtra)}}function $(h,y){if(1&h&&(l.TgZ(0,"div",8),l.YNc(1,L,2,1,"ng-container",3),l.qZA()),2&h){const m=l.oxw();l.xp6(1),l.Q6J("nzStringTemplateOutlet",m.nzExtra)}}const Z="collapse";let U=(()=>{class h{constructor(m,C,A,Q){this.nzConfigService=m,this.cdr=C,this.directionality=A,this.destroy$=Q,this._nzModuleName=Z,this.nzAccordion=!1,this.nzBordered=!0,this.nzGhost=!1,this.nzExpandIconPosition="left",this.dir="ltr",this.listOfNzCollapsePanelComponent=[],this.nzConfigService.getConfigChangeEventForComponent(Z).pipe((0,t.R)(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}ngOnInit(){this.directionality.change?.pipe((0,t.R)(this.destroy$)).subscribe(m=>{this.dir=m,this.cdr.detectChanges()}),this.dir=this.directionality.value}addPanel(m){this.listOfNzCollapsePanelComponent.push(m)}removePanel(m){this.listOfNzCollapsePanelComponent.splice(this.listOfNzCollapsePanelComponent.indexOf(m),1)}click(m){this.nzAccordion&&!m.nzActive&&this.listOfNzCollapsePanelComponent.filter(C=>C!==m).forEach(C=>{C.nzActive&&(C.nzActive=!1,C.nzActiveChange.emit(C.nzActive),C.markForCheck())}),m.nzActive=!m.nzActive,m.nzActiveChange.emit(m.nzActive)}}return h.\u0275fac=function(m){return new(m||h)(l.Y36(E.jY),l.Y36(l.sBO),l.Y36(I.Is,8),l.Y36(b.kn))},h.\u0275cmp=l.Xpm({type:h,selectors:[["nz-collapse"]],hostAttrs:[1,"ant-collapse"],hostVars:10,hostBindings:function(m,C){2&m&&l.ekj("ant-collapse-icon-position-left","left"===C.nzExpandIconPosition)("ant-collapse-icon-position-right","right"===C.nzExpandIconPosition)("ant-collapse-ghost",C.nzGhost)("ant-collapse-borderless",!C.nzBordered)("ant-collapse-rtl","rtl"===C.dir)},inputs:{nzAccordion:"nzAccordion",nzBordered:"nzBordered",nzGhost:"nzGhost",nzExpandIconPosition:"nzExpandIconPosition"},exportAs:["nzCollapse"],features:[l._Bn([b.kn])],ngContentSelectors:N,decls:1,vars:0,template:function(m,C){1&m&&(l.F$t(),l.Hsn(0))},encapsulation:2,changeDetection:0}),(0,f.gn)([(0,E.oS)(),(0,T.yF)()],h.prototype,"nzAccordion",void 0),(0,f.gn)([(0,E.oS)(),(0,T.yF)()],h.prototype,"nzBordered",void 0),(0,f.gn)([(0,E.oS)(),(0,T.yF)()],h.prototype,"nzGhost",void 0),h})();const J="collapsePanel";let K=(()=>{class h{constructor(m,C,A,Q,H,W){this.nzConfigService=m,this.ngZone=C,this.cdr=A,this.destroy$=Q,this.nzCollapseComponent=H,this.noAnimation=W,this._nzModuleName=J,this.nzActive=!1,this.nzDisabled=!1,this.nzShowArrow=!0,this.nzActiveChange=new l.vpe,this.nzConfigService.getConfigChangeEventForComponent(J).pipe((0,t.R)(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}markForCheck(){this.cdr.markForCheck()}ngOnInit(){this.nzCollapseComponent.addPanel(this),this.ngZone.runOutsideAngular(()=>(0,e.R)(this.collapseHeader.nativeElement,"click").pipe((0,B.h)(()=>!this.nzDisabled),(0,t.R)(this.destroy$)).subscribe(()=>{this.ngZone.run(()=>{this.nzCollapseComponent.click(this),this.cdr.markForCheck()})}))}ngOnDestroy(){this.nzCollapseComponent.removePanel(this)}}return h.\u0275fac=function(m){return new(m||h)(l.Y36(E.jY),l.Y36(l.R0b),l.Y36(l.sBO),l.Y36(b.kn),l.Y36(U,1),l.Y36(O.P,8))},h.\u0275cmp=l.Xpm({type:h,selectors:[["nz-collapse-panel"]],viewQuery:function(m,C){if(1&m&&l.Gf(v,7),2&m){let A;l.iGM(A=l.CRH())&&(C.collapseHeader=A.first)}},hostAttrs:[1,"ant-collapse-item"],hostVars:6,hostBindings:function(m,C){2&m&&l.ekj("ant-collapse-no-arrow",!C.nzShowArrow)("ant-collapse-item-active",C.nzActive)("ant-collapse-item-disabled",C.nzDisabled)},inputs:{nzActive:"nzActive",nzDisabled:"nzDisabled",nzShowArrow:"nzShowArrow",nzExtra:"nzExtra",nzHeader:"nzHeader",nzExpandedIcon:"nzExpandedIcon"},outputs:{nzActiveChange:"nzActiveChange"},exportAs:["nzCollapsePanel"],features:[l._Bn([b.kn])],ngContentSelectors:N,decls:8,vars:8,consts:[["role","button",1,"ant-collapse-header"],["collapseHeader",""],[4,"ngIf"],[4,"nzStringTemplateOutlet"],["class","ant-collapse-extra",4,"ngIf"],[1,"ant-collapse-content"],[1,"ant-collapse-content-box"],["nz-icon","",1,"ant-collapse-arrow",3,"nzType","nzRotate"],[1,"ant-collapse-extra"]],template:function(m,C){1&m&&(l.F$t(),l.TgZ(0,"div",0,1),l.YNc(2,R,2,1,"div",2),l.YNc(3,k,2,1,"ng-container",3),l.YNc(4,$,2,1,"div",4),l.qZA(),l.TgZ(5,"div",5)(6,"div",6),l.Hsn(7),l.qZA()()),2&m&&(l.uIk("aria-expanded",C.nzActive),l.xp6(2),l.Q6J("ngIf",C.nzShowArrow),l.xp6(1),l.Q6J("nzStringTemplateOutlet",C.nzHeader),l.xp6(1),l.Q6J("ngIf",C.nzExtra),l.xp6(1),l.ekj("ant-collapse-content-active",C.nzActive),l.Q6J("@.disabled",!(null==C.noAnimation||!C.noAnimation.nzNoAnimation))("@collapseMotion",C.nzActive?"expanded":"hidden"))},dependencies:[S.O5,M.Ls,P.f],encapsulation:2,data:{animation:[_.J_]},changeDetection:0}),(0,f.gn)([(0,T.yF)()],h.prototype,"nzActive",void 0),(0,f.gn)([(0,T.yF)()],h.prototype,"nzDisabled",void 0),(0,f.gn)([(0,E.oS)(),(0,T.yF)()],h.prototype,"nzShowArrow",void 0),h})(),Y=(()=>{class h{}return h.\u0275fac=function(m){return new(m||h)},h.\u0275mod=l.oAB({type:h}),h.\u0275inj=l.cJS({imports:[I.vT,S.ez,M.PV,P.T,O.g]}),h})()}}]);