<app-toolbar>
  <app-search-form placeholder="请输入名称"
    (onSearch)="search($event)"></app-search-form>
  <app-batch-btn 
    uploadApi="/api/role/import"
    downloadApi="/api/role/export"
    (add)="handleEdit()"
    (batchDel)="handleBatchDel()"></app-batch-btn>
</app-toolbar>

<ng-template #totalTemplate let-total>总共 {{ total }} 条</ng-template>
<nz-table #basicTable [nzData]="datum" [nzLoading]="loading"  nzShowPagination
  [nzFrontPagination]="false" nzShowSizeChanger [nzTotal]="total" [nzShowTotal]="totalTemplate"
  (nzPageSizeChange)="pageSizeChange($event)" (nzPageIndexChange)="pageIndexChange($event)" [nzPageSize]="pageSize"
  [nzPageIndex]="pageIndex" (nzQueryParams)="onQuery($event)">
  <thead>
    <tr>
      <th [nzChecked]="checked" [nzIndeterminate]="indeterminate" (nzCheckedChange)="handleAllChecked($event)"></th>
      <th nzColumnKey="id" [nzSortFn]="true">id</th>
      <th nzColumnKey="name">名称</th>
      <th nzColumnKey="privileges">权限</th>
      <th nzColumnKey="created" [nzSortFn]="true">创建时间</th>
      <th>操作</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let data of basicTable.data; let i = index">
      <td [nzChecked]="setOfCheckedId.has(data.id)" (nzCheckedChange)="handleItemChecked(data.id, $event)"></td>
      <td>{{ data.id }}</td>
      <td>{{ data.name }}</td>
      <td>{{ data.privileges | handlePrivileges }}</td>
      <td>{{ data.created | date }}</td>
      <td>
        <a (click)="handleEdit(data.id)">
          <i nz-icon nzType="edit"></i>
        </a>
        <nz-divider nzType="vertical"></nz-divider>
        <a nz-popconfirm nzPopconfirmTitle="确定删除?" (nzOnConfirm)="delete(data.id)" (nzOnCancel)="cancel()"
          nzPopconfirmPlacement="topLeft">
          <i nz-icon nzType="delete"></i>
        </a>
      </td>
    </tr>
  </tbody>
</nz-table>